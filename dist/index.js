"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let I={5e3:{branco:{1.2:30,1.4:35,1.6:40,1.8:45,2:50,2.2:55,2.4:60,2.6:65,3:70,3.2:75,3.4:80,3.6:85,4:90,4.4:95,5:100,6:110},inox:{1.2:35,1.4:40,1.6:45,1.8:50,2:55,2.2:60,2.4:65,2.6:70,3:75,3.2:80,3.4:85,3.6:90,4:95,4.4:100,5:105,6:115}}},s={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),calha:document.getElementById("calha-selector"),instalacao:document.getElementById("instalacao-selector")},k=document.getElementById("largura-input"),B=document.getElementById("altura-input"),$=document.getElementById("nome-input"),N=document.getElementById("email-input"),A=document.getElementById("contacto-switch"),O=document.getElementById("seguinte-btn"),b=document.getElementById("sim-container"),v=document.getElementById("checkout-container"),W=document.getElementById("new-window-contain"),F=document.getElementById("checkout-input-contain"),V=document.getElementById("new-window-btn"),q=document.getElementById("no-window-btn"),z=document.getElementById("enviar-btn"),C=[],r={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao")},u={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),instalacao:document.getElementById("checkout-instalacao")},m="inicio",o={inicio:"",tecido:"",tipo:"",bainha:"",medidas:"",correcao:"",calha:"",instalacao:"",nome:"",email:"",contacto:""},w=(e,t)=>{switch(t){case"Franzido":return e*2.5/100;case"Ondas":return e*2.7/100;case"Macho Juntos":return e*3/100;case"Pregas":return e*2.5/100}},X=(e,t)=>e*t,M=(e,t,c,a)=>{switch(e){case"Franzido":return t==="Blackout"?c*9:c*8;case"Ondas":return t==="Blackout"?c*8.5:c*7.5;case"Macho Juntos":return c*13.5;case"Pregas":return c*13.5}},_=e=>e?0:30,J=(e,t)=>{if(!e)return 0;let c=t.split(" X ")[0];if(c<300)return 30;if(c<400)return 40;if(c<500)return 45;if(c<600)return 50},j=(e,t)=>{let c=t.split(" X ")[0]/100,a=null,n=Object.keys(I[5e3].branco).sort((i,d)=>i-d);for(let i=0;i<n.length;i++)if(c<n[i]){a=I[5e3].branco[n[i]];break}return a},x=e=>{let t=w(e.medidas.split(" X ")[0],e.tipo),c=X(10,t),a=M(e.tipo,e.tecido,t,10),n=_(e.correcao)||0,i=J(e.instalacao,e.medidas)||0,d=j(e.calha,e.medidas)||0;return c+a+n+i+d},de=e=>{let t=0;return e.forEach(c=>{t+=x(c)}),t},l=(e,t)=>{e.style.display=t?"flex":"none"},g=(e,t)=>{o[e.id.split("-")[0]]=t},S=()=>{o.inicio="",o.tecido="",o.tipo="",o.bainha="",o.medidas="",o.correcao="",o.calha="",o.instalacao=""},E=e=>o[e]===""?(alert("Por favor selecione um valor"),!1):!0,y=e=>{r[e].classList.remove("active"),r[e].classList.remove("next"),r[e].classList.add("done"),r[e].getElementsByClassName("step_number")[0].classList.remove("active"),r[e].getElementsByClassName("step_description")[0].textContent=o[e],e==="medidas"&&(r[e].getElementsByClassName("step_description")[0].textContent+=o.correcao?"c/Verifica\xE7\xE3o":"s/Verifica\xE7\xE3o"),e==="tipo"&&(r[e].getElementsByClassName("step_description")[0].textContent+=o.bainha?"c/Ba\xEDnha de Chumbo":"s/Ba\xEDnha de Chumbo")},f=e=>{r[e].classList.remove("next"),r[e].classList.add("active"),r[e].getElementsByClassName("step_number")[0].classList.add("active")},ue=e=>{r[e].classList.add("next")},D=()=>{switch(m){case"inicio":E("inicio")&&(l(s.inicio,!1),l(s.tecido,!0),m="tecido");break;case"tecido":E("tecido")&&(y("tecido"),f("tipo"),l(s.tecido,!1),l(s.tipo,!0),m="tipo");break;case"tipo":E("tipo")&&(l(s.tipo,!1),l(s.bainha,!0),m="bainha");break;case"bainha":g(s.bainha,`${k.value} X ${B.value}`),E("bainha")&&(y("tipo"),f("medidas"),l(s.bainha,!1),l(s.medidas,!0),m="medidas");break;case"medidas":if(k.value===""||B.value===""){alert("Por favor preencha todos os campos");return}g(s.medidas,`${k.value} X ${B.value}`),E("medidas")&&(l(s.medidas,!1),l(s.correcao,!0),m="correcao");break;case"correcao":y("medidas"),f("calha"),l(s.correcao,!1),l(s.calha,!0),m="calha";break;case"calha":E("calha")&&(y("calha"),f("instalacao"),l(s.calha,!1),l(s.instalacao,!0),m="instalacao");break;case"instalacao":K(),y("instalacao"),l(s.instalacao,!1),R();break}},R=()=>{b.style.display="none",v.style.display="flex"},P=e=>{v.style.display="none",b.style.display="flex",(e==="largura"||e==="altura")&&(e="medidas"),l(s[e],!0),m=e,f(e)},Y=()=>{document.querySelectorAll("[id^='inicio-card']").forEach(t=>{t.addEventListener("click",()=>{g(s.inicio,t.getElementsByTagName("h1")[0].textContent)})})},H=()=>{document.querySelectorAll("[id^='tecido-card']").forEach(t=>{t.addEventListener("click",()=>{g(s.tecido,t.getElementsByTagName("h1")[0].textContent)})})},Q=()=>{document.querySelectorAll("[id^='calha-card']").forEach(t=>{t.addEventListener("click",()=>{g(s.calha,t.getElementsByTagName("h1")[0].textContent)})})},Z=()=>{document.querySelectorAll("[id^='tipo-card']").forEach(t=>{t.addEventListener("click",()=>{g(s.tipo,t.getElementsByTagName("h1")[0].textContent)})})},L=document.querySelector("#correcao-switch");L.addEventListener("change",function(e){g(s.correcao,L.checked)});let T=document.querySelector("#instalacao-switch");T.addEventListener("change",function(e){g(s.instalacao,T.checked)});let G=()=>{document.querySelectorAll(".tecido_color").forEach(e=>{e.addEventListener("click",t=>{let c=t.currentTarget,a=c.id,n=c.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0],i=document.querySelectorAll("[id^='color-thumbnail-image']");for(let d=0;d<i.length;d++)if(i[d].textContent===a){n.setAttribute("src",i[d].style.backgroundImage.split('"')[1]),n.setAttribute("srcset","");break}})})},K=()=>{u.tecido.textContent=o.tecido,u.tipo.textContent=o.tipo,u.largura.textContent=o.medidas.split(" X ")[0]+"cm Largura",u.altura.textContent=o.medidas.split(" X ")[1]+"cm Altura",u.correcao.textContent=o.correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",u.calha.textContent=o.calha,u.instalacao.textContent=o.instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"},U=()=>{Object.keys(u).forEach(e=>{u[e].addEventListener("click",()=>{P(e)})})},ee=()=>{z.addEventListener("click",()=>{o.nome=$.value,o.email=N.value,o.contacto=A.checked,ne()})},te=()=>{V.addEventListener("click",oe)},ae=()=>{q.addEventListener("click",()=>{S(),W.style.display="none",F.style.display="flex"})},ce=()=>{let e={tecido:o.tecido,tipo:o.tipo,medidas:o.medidas,correcao:o.correcao,calha:o.calha,instalacao:o.instalacao};C.push(e)},oe=()=>{ce(),S(),P("tecido")},ne=()=>{let{jsPDF:e}=window.jspdf,t=new e,c=10,a=10,n=10,i=[],d=0;C.forEach((h,p)=>{p%3===0&&p!==0&&(t.addPage(),a=10),i.push(x(h)),d+=i[p],t.setFontSize(12),t.text(`Janela ${p+1}`,c,a),t.setFontSize(8),a+=n;let le=h.correcao?"Sim":"N\xE3o",re=h.instalacao?"Sim":"N\xE3o";t.text(`Tecido: ${h.tecido}`,c,a),a+=n,t.text(`Tipo: ${h.tipo}`,c,a),a+=n,t.text(`Medidas: ${h.medidas}`,c,a),a+=n,t.text(`Com Verifica\xE7\xE3o: ${le}`,c,a),a+=n,t.text(`Calha: ${h.calha}`,c,a),a+=n,t.text(`Com Instala\xE7\xE3o: ${re}`,c,a),a+=n,t.text("---------------------",c,a),a+=n,t.setFontSize(16),t.text(`Pre\xE7o: ${i[p]}`,c,a),a+=n,a+=n}),t.addPage(),a=10,t.setFontSize(12),t.text("Resumo",c,a),t.setFontSize(8),a+=n,C.forEach((h,p)=>{t.text(`Janela ${p+1}: ${i[p]}`,c,a),a+=n}),a+=n,t.text(`Total: ${d}`,c,a),a+=n,t.setFontSize(12),t.text(`Nome: ${o.nome}`,c,a),a+=n,t.text(`Email: ${o.email}`,c,a),a+=n,t.save("generated.pdf"),ie()},se=()=>{let e=125;for(let t=0;t<5;t++)e=125+t*125,C.push({tecido:"105 102",tipo:"Ondas",medidas:`${e} X 250`,correcao:t%2!==0,calha:"5000 - Branco",instalacao:t%2===0})},ie=()=>{fetch("https://docs.google.com/spreadsheets/d/1rLeS62q8uY3PPSRZSEokJY7q5uS4Qh9aNx8VFPg2cF8/export?format=csv").then(e=>e.text()).then(e=>{debugger;console.log(e)}).catch(e=>console.error("Error fetching CSV data:",e))};O.addEventListener("click",D),Y(),H(),Q(),Z(),G(),ee(),te(),ae(),U(),se()});})();
