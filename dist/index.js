"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let Ge="https://cdn.prod.website-files.com/66aadbd497db3d8c63799460/66eb5ac454e950633d646ea2_testlogo.jpg",D={},da={Branco:"B",Inox:"I",Bronze:"BZ",Preto:"P",Nogueira:"N",Chumbo:"CH"},F={estores:{width:[80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],height:[80,100,120,140,160,180,200,220,240,260,280,300,320]},calhas:{"5000-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"1500-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"9500M":[150,200,250,300,350,400,450,500,600,650,700,750,800,850,900,1e3,1200],KS:[160,200,240,300,400,500,600],"DSXL-B":[160,200,240,300,400,600],"DSXL-CZ":[160,200,240,300,400,600],"DSXL-P":[160,200,240,300,400,600]}},oe=[],h=[],f="inicio",l={inicio:"",tecido:"",tipo:"",bainha:"",medidas:"",correcao:"",calha:"",suporte:"",instalacao:"",nome:"",email:"",contacto:""},g={usedWidths:[{name:"Franzido",widthRatio:2.5},{name:"Ondas",widthRatio:2.7},{name:"Macho Juntos",widthRatio:3},{name:"Pregas",widthRatio:2.5}],manufacturingPrices:[{name:"Franzido",blackout:9,normal:8},{name:"Ondas",blackout:8.5,normal:7.5},{name:"Macho Juntos",normal:13.5,blackout:13.5,alinhado:12.5},{name:"Pregas",normal:13.5,blackout:13.5,alinhado:12.5}],bainhaPrice:{price:3.5,widthMargin:20},uniao:{maxLength:400,price:8.6,calha9500M:15},prolongadores:3.7,roletesPrice:5,minWindowWidthEstores:80,maxWindowWidthEstores:300,minWindowHeightEstores:80,maxWindowHeightEstores:300,maxWindowWidth:650,maxWindowHeight:280,maxCalhaWidth:600,measuresCheckPrice:30,instalation:[{maxWidth:300,price:35},{maxWidth:400,price:40},{maxWidth:500,price:45},{maxWidth:600,price:50},{maxWidth:650,price:55}]},L=!0,Be=document.getElementById("sim-container"),se=document.getElementById("steps-cortina"),ie=document.getElementById("steps-estore"),m={step1:document.getElementById("simulator-heading-1"),step1i:document.getElementById("inicio-description"),step1c:document.getElementById("inicio-description-c"),step1e:document.getElementById("inicio-description-e"),step2:document.getElementById("simulator-heading-2"),step3:document.getElementById("simulator-heading-3"),step4:document.getElementById("simulator-heading-4"),step5:document.getElementById("simulator-heading-5")},n={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),suporte:document.getElementById("suporte-selector"),instalacao:document.getElementById("instalacao-selector")},ve=document.getElementById("largura-input-descr-c"),Ie=document.getElementById("altura-input-descr-c"),ke=document.getElementById("largura-input-descr-e"),Le=document.getElementById("altura-input-descr-e"),v=document.getElementById("largura-input"),I=document.getElementById("altura-input"),H=document.querySelector("#correcao-switch"),Z=document.querySelector("#bainha"),q=document.getElementById("tecto-radio-btn"),A=document.getElementById("parede-radio-btn"),U=document.querySelector("#instalacao-switch"),ne=document.getElementById("largura-min-error-estore"),ce=document.getElementById("altura-min-error-estore"),re=document.getElementById("largura-max-error-estore"),le=document.getElementById("altura-max-error-estore"),de=document.getElementById("largura-error"),ue=document.getElementById("altura-error"),w=document.getElementById("seguinte-btn"),u={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao"),medidasEstore:document.getElementById("step-medidas-estore"),instalacaoEstore:document.getElementById("step-instalacao-estore")},K=document.getElementById("form"),me=document.getElementById("nome-input"),he=document.getElementById("email-input"),Qe=document.getElementById("contacto-switch"),Pe=document.getElementById("checkout-container"),et=document.getElementById("new-window-contain"),tt=document.getElementById("checkout-input-contain"),We=document.getElementById("checkout-info-estore"),Se=document.getElementById("checkout-info-cortina"),at=document.getElementById("new-window-btn"),ot=document.getElementById("no-window-btn"),j=document.getElementById("enviar-btn"),W={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),bainha:document.getElementById("checkout-bainha"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),suporte:document.getElementById("checkout-suporte"),instalacao:document.getElementById("checkout-instalacao"),estoreProduto:document.getElementById("checkout-produto-estore"),estoreLargura:document.getElementById("checkout-largura-estore"),estoreAltura:document.getElementById("checkout-altura-estore"),estoreCorrecao:document.getElementById("checkout-correcao-estore"),estoreInstalacao:document.getElementById("checkout-instalacao-estore")},ua=document.getElementById("feedback-div"),Y=document.getElementById("name-error"),X=document.getElementById("email-error"),$e=document.getElementById("contacto-switch-error"),st=document.getElementById("cortina-radio-btn"),it=document.getElementById("estore-radio-btn"),nt=document.getElementById("calha-radio-btn"),ct=()=>{Ut(),Tt(),Ot(),_t(),At(),zt(),Xt(),Ft(),Vt(),Ht(),qt(),Rt(),Mt(),Dt(),Nt()},rt=()=>{dt(),ct()},lt=e=>{let t=0,s=0,a="",o=e.tecido.split("-"),r=o[0],d=o[1],c=e.calha?e.calha.split("-"):null,E=c?c[0]:null,C=c?c[1]:null,y=e.medidas?e.medidas.split(" X ")[0]:0;if(e.inicio==="Cortina"&&(a=`${r}${d}`),e.inicio==="Estore"){let z=e.medidas?e.medidas.split(" X ")[1]:0;a=pt(r,d,y,z)}if(t=typeof D[a].price=="string"?parseFloat(D[a].price):D[a].price,e.inicio==="Estore")return{product:t,calha:0};let P=(y/g.maxCalhaWidth|0)+1,k=y<=g.maxCalhaWidth?y:y/P,T=ft(E,e.tipo,C,k,e?.suporte==="Parede");return s=D[T]?y<g.maxCalhaWidth?D[T].price:D[T].price*P:0,s+=y>g.maxCalhaWidth?g.prolongadores*P:y>g.uniao.maxLength&&e.calha.startsWith("9500M")?g.uniao.calha9500M*P:y>g.uniao.maxLength?g.uniao.price*P:0,(T.startsWith("5000")||T.startsWith("1500"))&&(s+=y<g.maxCalhaWidth?g.roletesPrice:g.roletesPrice*P),{product:t,calha:s}},dt=()=>{fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vSCprbghTI2dhOxsCMkcEHhI-DE5pOb5RnOKO3KPd5-ntAORtuPTuFonSvs9s4-ANy_VCezuEdcZ8pg/pub?gid=0&single=true&output=csv").then(e=>e.text()).then(e=>{let t=e.trim().split(`
`),s=t[0].split(","),a=t.slice(1).map(r=>r.split(",")),o={};a.forEach(r=>{let[d,c]=r;o[d]||(o[d]={id:d,price:parseFloat(c)})}),D=o}).catch(e=>console.error("Error fetching CSV data:",e))},x=(e,t)=>{l[e.id.split("-")[0]]=t},pe=e=>{l.calha=e},Te=e=>{l.suporte=A.checked?"Parede":"Tecto"},ut=()=>{l.inicio="",l.tecido="",l.tipo="",l.bainha="",l.medidas="",l.correcao="",l.calha="",l.suporte="",l.instalacao=""},mt=e=>{e.inicio==="Cortina"&&(x(n.inicio,"Cortina"),x(n.tecido,e.tecido),x(n.tipo,e.tipo),x(n.bainha,e.bainha),x(n.medidas,e.medidas),x(n.correcao,e.correcao),x(n.suporte,e.suporte),x(n.instalacao,e.instalacao)),e.inicio==="Estore"&&(x(n.inicio,"Estore"),x(n.tecido,e.tecido),x(n.medidas,e.medidas),x(n.correcao,e.correcao),x(n.instalacao,e.instalacao))},fe=()=>{let e={inicio:l.inicio,bainha:l.bainha,tecido:l.tecido,tipo:l.tipo,medidas:l.medidas,correcao:l.correcao,calha:l.calha,suporte:l.suporte,instalacao:l.instalacao};h.push(e),L=!1},ht=()=>{O("Cortina"),ut(),yt(),ze(),De("inicio"),L=!0},b=()=>{switch(f){case"inicio":return l.inicio===""?(p(!1),!1):(p(!0),!0);case"tecido":return l.tecido===""?(p(!1),!1):(p(!0),!0);case"tipo":return l.tipo===""?(p(!1),!1):(p(!0),!0);case"medidas":return v?.value===""||I?.value===""?(p(!1),!1):l.inicio==="Cortina"?parseInt(v?.value)>g.maxWindowWidth||parseInt(I?.value)>g.maxWindowHeight?(parseInt(v?.value)>g.maxWindowWidth?de.style.display="block":de.style.display="none",parseInt(I?.value)>g.maxWindowHeight?ue.style.display="block":ue.style.display="none",p(!1),!1):(p(!0),!0):l.inicio==="Estore"?parseInt(v?.value)<g.minWindowWidthEstores||parseInt(I?.value)<g.minWindowHeightEstores?(parseInt(v?.value)<g.minWindowWidthEstores?ne.style.display="block":ne.style.display="none",parseInt(I?.value)<g.minWindowHeightEstores?ce.style.display="block":ce.style.display="none",p(!1),!1):parseInt(v?.value)>g.maxWindowWidthEstores||parseInt(I?.value)>g.maxWindowHeightEstores?(parseInt(v?.value)>g.maxWindowWidthEstores?re.style.display="block":re.style.display="none",parseInt(I?.value)>g.maxWindowHeightEstores?le.style.display="block":le.style.display="none",p(!1),!1):(p(!0),!0):(de.style.display="none",ue.style.display="none",ne.style.display="none",ce.style.display="none",re.style.display="none",le.style.display="none",p(!0),!0);case"calha":return l.calha===""?(p(!1),!1):(p(!0),!0);case"suporte":return l.suporte===""?(p(!1),!1):(p(!0),!0)}return p(!0),!0},pt=(e,t,s,a)=>{let o=F.estores.width.find(d=>d>=s),r=F.estores.height.find(d=>d>=a);return`${e}${r}${o}`},ft=(e,t,s,a,o)=>{if(e==="KS"){if(o){let c=F.calhas[e]?.find(E=>E>=a);return`${e}${t==="Franzido"?"F":"O"}${c}SP`}let d=F.calhas[e]?.find(c=>c>=a);return`${e}${t==="Franzido"?"F":"O"}${d}`}if(e==="DSXL"){if(o){let c=F.calhas[`${e}-${s}`]?.find(E=>E>=a);return`${e}${t==="Franzido"?"F":"O"}${c}${s}SP`}let d=F.calhas[`${e}-${s}`]?.find(c=>c>=a);return`${e}${t==="Franzido"?"F":"O"}${d}${s}`}if(e==="9500M"){if(o){let c=F.calhas[e].find(E=>E>=a);return`${e}${c}SP`}let d=F.calhas[e].find(c=>c>=a);return`${e}${d}`}if(o){let d=F.calhas[`${e}-${s}`].find(c=>c>=a);return`${e}${d}${s}SP`}let r=F.calhas[`${e}-${s}`].find(d=>d>=a);return`${e}${r}${s}`},gt=e=>{let t=e.getElementsByClassName("color_name");return t.length>0?t[0].textContent:null},Oe=e=>{let t=e.getElementsByClassName("product_name");return t.length>0?t[0].textContent:null},Et=e=>{switch(e){case"tecido":case"inicio":return"step1";case"tipo":case"bainha":return"step2";case"medidas":case"correcao":return"step3";case"calha":return"step4";case"instalacao":return"step5"}},O=e=>{e==="Estore"&&it?.click(),e==="Cortina"&&st?.click(),e==="Calha"&&nt?.click()},yt=()=>{let e=document.querySelectorAll("[id^='inicio-card']"),t=document.querySelectorAll("[id^='tipo-card']"),s=document.querySelectorAll("[id^='tecido-card']"),a=document.querySelectorAll(".tecido_color");e.forEach(o=>{_(o)}),t.forEach(o=>{_(o)}),s.forEach(o=>{_(o)}),a.forEach(o=>{Ee(o)}),v.value="",I.value="",H.checked=!1,U.checked=!1,A?.click(),Z.checked=!1},Fe=e=>{document.querySelectorAll("[id^='inicio-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?R(s):_(s)})},_e=e=>{document.querySelectorAll("[id^='tecido-card']").forEach(s=>{Oe(s).startsWith(e)?R(s):_(s)})},xt=e=>{document.querySelectorAll("[id^='tipo-card']").forEach(s=>{s.getElementsByTagName("h1")[0].textContent===e?R(s):_(s)})},Ct=e=>{e==="Parede"?A.click():q.click()},bt=()=>{q.checked=!1,A.checked=!1},G=()=>{let e=document.querySelector("#checkout-window-btn"),t=document.getElementById("window-btns-container");if(h.length===1&&(h[0].button=e,Xe(h[0])),h.length>1&&e){let s=e.cloneNode(!0);s.querySelector(".checkout_info_title").textContent=`Janela ${h.length}`,h[h.length-1].button=s,Xe(h[h.length-1]),t?.appendChild(s)}},Bt=e=>{e.inicio==="Cortina"&&(Fe(e.inicio),_e(e.tecido),xt(e.tipo),Z.checked=e.bainha,v.value=e.medidas.split(" X ")[0],I.value=e.medidas.split(" X ")[1],H.checked=e.correcao,Ct(e.suporte),U.checked=e.instalacao),e.inicio==="Estore"&&(Fe(e.inicio),_e(e.tecido),v.value=e.medidas.split(" X ")[0],I.value=e.medidas.split(" X ")[1],H.checked=e.correcao,U.checked=e.instalacao)},Q=e=>{e==="inicio"&&(m.step1i.style.display="flex",m.step1c.style.display="none",m.step1e.style.display="none"),e==="tecido"&&l.inicio==="Cortina"&&(m.step1i.style.display="none",m.step1c.style.display="flex",m.step1e.style.display="none"),e==="tecido"&&l.inicio==="Estore"&&(m.step1i.style.display="none",m.step1c.style.display="none",m.step1e.style.display="flex")},vt=e=>{if((e==="largura"||e==="altura")&&(e="medidas"),e===f)return;let t=!1;if((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||e==="medidasEstore")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura"||e==="medidasEstore")&&(e="medidas"),e==="estoreCorrecao"&&(e="correcao"),e==="estoreInstalacao"&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),u[e].classList.contains("done")){switch($t(f),i(m[Et(f)],!1),i(f==="calha"?n.tecido:n[f],!1),Q(e),e){case"tecido":O(t?"Estore":"Cortina"),i(m.step1,!0),i(n.tecido,!0);break;case"tipo":i(m.step2,!0),i(n.tipo,!0);break;case"medidas":i(m.step3,!0),i(n.medidas,!0);break;case"calha":O("calha"),i(m.step4,!0),i(n.tecido,!0);break;case"instalacao":i(m.step5,!0),i(n.instalacao,!0);break}f=e,b(),S(e)}},Ae=()=>{l.inicio==="Cortina"&&(ve.style.display="block",Ie.style.display="block",ke.style.display="none",Le.style.display="none"),l.inicio==="Estore"&&(ve.style.display="none",Ie.style.display="none",ke.style.display="block",Le.style.display="block")},It=()=>{if(l.inicio==="Cortina")switch(f){case"inicio":b()&&(M("Cortina"),i(n.inicio,!1),Q("tecido"),L&&p(!1),i(n.tecido,!0),f="tecido");break;case"tecido":b()&&(Q("tecido"),B("tecido"),S("tipo"),i(m.step1,!1),L&&p(!1),i(n.tecido,!1),i(m.step2,!0),i(n.tipo,!0),Ae(),f="tipo");break;case"tipo":b()&&(i(n.tipo,!1),l.tecido.startsWith("120")||l.tecido.startsWith("122")?(x(n.bainha,!0),L&&p(!1),B("tipo"),S("medidas"),i(m.step2,!1),i(m.step3,!0),i(n.medidas,!0),f="medidas"):(i(n.bainha,!0),f="bainha"));break;case"bainha":x(n.bainha,`${l.tecido.startsWith("120")||l.tecido.startsWith("122")?!0:l.bainha?l.bainha:!1}`),B("tipo"),S("medidas"),i(m.step2,!1),i(n.bainha,!1),L&&p(!1),i(m.step3,!0),i(n.medidas,!0),f="medidas";break;case"medidas":b()&&(x(n.medidas,`${v?.value} X ${I?.value}`),i(n.medidas,!1),h.length>0?(L&&p(!1),O("Calha"),B("medidas"),S("calha"),i(m.step3,!1),i(m.step4,!0),i(n.tecido,!0),f="calha"):(i(n.correcao,!0),f="correcao"));break;case"correcao":O("Calha"),B("medidas"),S("calha"),i(m.step3,!1),i(n.correcao,!1),L&&p(!1),i(m.step4,!0),i(n.tecido,!0),f="calha";break;case"calha":b()&&(i(n.tecido,!1),L&&p(!1),bt(),i(n.suporte,!0),f="suporte");break;case"suporte":x(n.suporte,A?.checked?"Parede":"Tecto"),b()&&(B("calha"),S("instalacao"),i(m.step4,!1),i(n.suporte,!1),h.length>0?(L&&(fe(),G()),ee()):(i(m.step5,!0),i(n.instalacao,!0),f="instalacao"));break;case"instalacao":B("instalacao"),i(m.step5,!1),i(n.instalacao,!1),L&&(fe(),G()),ee();break}else switch(f){case"inicio":b()&&(M("Estore"),i(n.inicio,!1),Q("tecido"),L&&p(!1),i(n.tecido,!0),f="tecido");break;case"tecido":b()&&(B("tecido"),S("medidas"),i(m.step1,!1),i(n.tecido,!1),Ae(),L&&p(!1),i(m.step3,!0),i(n.medidas,!0),f="medidas");break;case"medidas":b()&&(i(n.medidas,!1),h.length>0?(B("medidas"),S("instalacao"),i(m.step3,!1),i(m.step5,!0),i(n.instalacao,!0),f="instalacao"):(i(n.correcao,!0),f="correcao"));break;case"correcao":B("medidas"),S("instalacao"),i(m.step3,!1),i(n.correcao,!1),h.length>0?(G(),ee()):(i(m.step5,!0),i(n.instalacao,!0),f="instalacao");break;case"instalacao":B("instalacao"),i(m.step5,!1),i(n.instalacao,!1),L&&(fe(),G()),ee();break}},ee=()=>{Be.style.display="none",Ne(h[h.length-1]),M(),Pe.style.display="flex"},kt=e=>{e.inicio==="Cortina"&&(We.style.display="none",Se.style.display="flex",W.tecido.textContent=e.tecido,W.tipo.textContent=e.tipo,W.bainha.textContent=e.tipo==="Ondas"||e.tipo==="Franzido"?"Ba\xEDnha de Chumbo inclu\xEDda":e.bainha?"Com Ba\xEDnha de Chumbo":"Sem Ba\xEDnha de Chumbo",W.largura.textContent=e.medidas.split(" X ")[0]+"cm Largura",W.altura.textContent=e.medidas.split(" X ")[1]+"cm Altura",W.correcao.textContent=h[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",W.calha.textContent=e.calha,W.suporte.textContent="Suporte de "+e.suporte,W.instalacao.textContent=h[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio==="Estore"&&(We.style.display="flex",Se.style.display="none",W.estoreProduto.textContent=e.tecido,W.estoreLargura.textContent=e.medidas.split(" X ")[0]+"cm",W.estoreAltura.textContent=e.medidas.split(" X ")[1]+"cm",W.estoreCorrecao.textContent=h[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",W.estoreInstalacao.textContent=h[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o")},Lt=e=>{e.inicio==="Cortina"&&(B("tecido"),B("tipo"),B("medidas"),B("calha"),B("instalacao")),e.inicio==="Estore"&&(B("tecido"),B("medidasEstore"),B("instalacaoEstore"))},Ne=e=>{h.forEach(t=>{t.button&&t.button.classList.remove("active")}),e.button.classList.add("active"),kt(e),Bt(e),mt(e),Lt(e)},De=e=>{Pe.style.display="none",L&&ze(),M(),Be.style.display="flex";let t=!1;if((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura")&&(e="medidas"),(e==="estoreCorrecao"||e==="correcao")&&(e="medidas"),(e==="estoreInstalacao"||e==="instalacao")&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),M(t?"Estore":"Cortina"),t)O("Estore");else switch(e){case"inicio":i(m.step1,!0),i(n.inicio,!0);break;case"tecido":O(t?"Estore":"Cortina"),i(m.step1,!0),i(n.tecido,!0);break;case"tipo":i(m.step2,!0),i(n.tipo,!0);break;case"medidas":i(m.step3,!0),i(n.medidas,!0);break;case"calha":O("Calha"),i(m.step4,!0),i(n.tecido,!0);break;case"suporte":i(m.step4,!0),i(n.suporte,!0);break;case"instalacao":i(m.step5,!0),i(n.instalacao,!0);break}if(f=e,f==="inicio")return S("tecido");t&&((e==="medidas"||e==="correcao")&&S("medidasEstore"),e==="instalacao"&&S("instalacaoEstore")),S(e),L=!1},ma=async e=>{let t=Buffer.from(e,"base64"),a=await(await PDFDocument.load(t)).save();return Buffer.from(a).toString("base64")},ha=async e=>await(await fetch(e)).arrayBuffer(),Pt=async()=>{let{PDFDocument:e,rgb:t}=PDFLib,s=await e.create(),a=s.addPage([595.28,841.89]),o=800,r=50,d=520,c=12,E=0,C=await s.embedFont(PDFLib.StandardFonts.Helvetica),y=await s.embedFont(PDFLib.StandardFonts.HelveticaBold),P=o,k=null;try{k=await St(Ge);let $=await fetch(k).then(V=>V.arrayBuffer()),te=await s.embedPng($),{width:Ce,height:be}=te.scale(1),J=100,ae=be/Ce*J,Ye=(a.getWidth()-J)/2;a.drawImage(te,{x:Ye,y:P-10,width:J,height:ae})}catch($){console.error("Error loading logo:",$)}let T="Cliente:",z="Data:",qe="Email:",Ue=new Date().toLocaleDateString(),ea=y.widthOfTextAtSize(T,8),we=y.widthOfTextAtSize(z,8),ta=y.widthOfTextAtSize(qe,8),aa=C.widthOfTextAtSize(Ue,8);a.drawText(T,{x:r,y:P,size:8,font:y}),a.drawText(`${l.nome}`,{x:r+ea+2,y:P,size:8,font:C});let oa=we+aa+2,je=d-oa;a.drawText(z,{x:je,y:P,size:8,font:y}),a.drawText(Ue,{x:je+we+2,y:P,size:8,font:C});let ye=P-c;a.drawText(qe,{x:r,y:ye,size:8,font:y}),a.drawText(`${l.email}`,{x:r+ta+2,y:ye,size:8,font:C}),o=ye-c*2,a.drawLine({start:{x:r,y:o},end:{x:d,y:o},thickness:.5,color:t(0,0,0)}),o-=c,a.drawText("Descri\xE7\xE3o",{x:r,y:o,size:10,fontBold:y}),a.drawText("Pre\xE7o",{x:d-100,y:o,size:10,fontBold:y}),o-=c,a.drawLine({start:{x:r,y:o},end:{x:d,y:o},thickness:.5,color:t(0,0,0)}),o-=c,h.forEach(($,te)=>{if(o<100){let V=s.addPage([595.28,841.89]);o=800}let{tecido:Ce,calha:be,instalacao:J,total:ae}=Me($);E+=ae,a.drawText(`Janela ${te+1} - ${$.medidas} CM - (Largura Utilizada: ${parseInt(parseFloat($.usedWidth).toFixed(2))} CM)`,{x:r,y:o,size:8,fontBold:y}),o-=c,[{label:"Tecido",price:Ce,subItems:[{label:`Modelo: ${$.tecido}`},{label:`Tipo de Cortina: ${$.tipo}`},{label:`Ba\xEDnha: ${$.tecido.startsWith("120")||$.tecido.startsWith("122")?"Inclu\xEDda":$.bainha?"Sim":"N\xE3o"}`}]},{label:"Calha",price:be,subItems:[{label:`Suporte: Suporte de ${$.suporte}`}]},{label:"Instala\xE7\xE3o",price:J,subItems:[]}].forEach(V=>{a.drawText(`  - ${V.label}`,{x:r,y:o,size:8,font:y}),a.drawText(`${V.price.toFixed(2)}\u20AC`,{x:d-100,y:o,size:8,fontReg:C}),o-=c,V.subItems.forEach(la=>{a.drawText(`      \u2022 ${la.label}`,{x:r+20,y:o,size:8,font:C}),o-=c}),o-=c}),a.drawText("Total",{x:r,y:o,size:10,font:y}),a.drawText(`${ae.toFixed(2)}\u20AC`,{x:d-100,y:o,size:10,fontReg:C}),o-=c,a.drawLine({start:{x:r,y:o},end:{x:d,y:o},thickness:.5,color:t(0,0,0)}),o-=c});let sa=h[0].correcao?"Com corre\xE7\xE3o de medidas":"Medidas facultadas pelo cliente";a.drawText(`Corre\xE7\xE3o: ${sa}`,{x:r,y:o,size:10,fontReg:C});let Je=h[0].correcao?30:0;E+=Je,a.drawText(`${Je.toFixed(2)}\u20AC`,{x:d-100,y:o,size:10,fontReg:C}),o-=c*2,a.drawText("Total:",{x:d-150,y:o,size:12,fontBold:y}),a.drawText(`${E.toFixed(2)}\u20AC`,{x:d-100,y:o,size:12,fontBold:y}),o-=c*4;let N=100;a.drawText("Valores com IVA incluido \xE0 taxa em vigor. Or\xE7amento v\xE1lido por 15 dias.",{x:r,y:N,size:8,fontReg:C}),a.drawText("Calhas j\xE1 incluem os rod\xEDzios e suportes necess\xE1rios para as medidas selecionadas.",{x:r,y:N-c,size:8,fontReg:C}),a.drawText("Valor referente \xE0 instala\xE7\xE3o e Rectifica\xE7\xE3o de Medidas sujeito a valida\xE7\xE3o do c\xF3digo postal.",{x:r,y:N-2*c,size:8,fontReg:C}),a.drawText("IBAN: PT50 0000 0000 0000 0000 0",{x:r,y:N-3*c,size:8,fontReg:C}),a.drawLine({start:{x:r,y:N-4*c},end:{x:d,y:N-4*c},thickness:.5,color:t(0,0,0)});let ia="www.fabricstore.pt",Ze="Pag. 1 de 1",na=C.widthOfTextAtSize(Ze,8),ca=(a.getWidth()-na)/2;a.drawText(ia,{x:r,y:N-5*c,size:10,fontReg:C}),a.drawText(Ze,{x:ca,y:N-5*c,size:8,fontReg:C});let ra=await s.save(),Ke=new Blob([ra],{type:"application/pdf"}),xe=document.createElement("a");return xe.href=URL.createObjectURL(Ke),xe.download="Orcamento_Fabric-Store.pdf",xe.click(),Ke},Wt=async()=>{let e=0,t="";t+=`Data: ${new Date().toLocaleDateString()}

`,t+=`Cliente: ${l.nome}

`,t+=`Email: ${l.email}

`;let s=h[0].correcao?"  Com corre\xE7\xE3o de medidas:":"  Medidas facultadas pelo cliente:",a=h[0].correcao?30:0;h.forEach((d,c)=>{let{usedWidth:E,productPrice:C,manufacturingPrice:y,bainhaPrice:P,calhaPrice:k,instalationPrice:T,windowTotal:z}=Me(d);e+=z,t+=`Janela ${c+1} - ${d.medidas} CM - (Largura Utilizada: ${parseInt(parseFloat(E).toFixed(2))} CM): ${z.toFixed(2)}\u20AC

`,t+=`  Pre\xE7o do Produto: ${C.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o de Fabrica\xE7\xE3o: ${y.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o da Bainha: ${P.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o da Calha: ${k.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o da Instala\xE7\xE3o: ${T.toFixed(2)}\u20AC

`}),t+=`Corre\xE7\xE3o:
${s} ${a.toFixed(2)}\u20AC

`,e+=a,t+=`Total: ${e.toFixed(2)}\u20AC

`;let o=new Blob([t],{type:"text/plain"}),r=document.createElement("a");return r.href=URL.createObjectURL(o),r.download="Orcamento_Fabric-Store.txt",r.click(),o},St=e=>new Promise((t,s)=>{let a=new Image;a.crossOrigin="Anonymous",a.src=e,a.onload=()=>{let o=document.createElement("canvas");o.width=a.width,o.height=a.height,o.getContext("2d").drawImage(a,0,0);let d=o.toDataURL("image/png");t(d)},a.onerror=o=>{s(new Error(`Failed to load image from ${e}: ${o.message}`))}}),pa=e=>{e.classList.add("show"),gsap.fromTo(e,{opacity:0},{opacity:1,duration:1,ease:"power1.in"})},M=e=>{e||(se.style.display="none",ie.style.display="none"),e==="Cortina"&&(se.style.display="flex",ie.style.display="none"),e==="Estore"&&(se.style.display="none",ie.style.display="flex")},i=(e,t)=>{e.style.display=t?"flex":"none"},ze=()=>{Object.keys(u).forEach(e=>{u[e].classList.remove("active"),u[e].classList.add("next"),u[e].classList.remove("done"),u[e].getElementsByClassName("step_number")[0].classList.remove("active"),u[e].getElementsByClassName("step_description")[0].textContent="Escolha"})},B=e=>{u[e].classList.remove("active"),u[e].classList.remove("next"),u[e].classList.add("done"),u[e].getElementsByClassName("step_number")[0].classList.remove("active"),u[e].getElementsByClassName("step_description")[0].classList.contains("next")&&u[e].getElementsByClassName("step_description")[0].classList.remove("next"),u[e].getElementsByClassName("step_description")[0].textContent=l[e],e==="instala\xE7\xE3o"&&(u.instalacaoEstore?.classList.remove("active"),u.instalacaoEstore?.classList.remove("next"),u.instalacaoEstore?.classList.add("done"),u.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),u.instalacaoEstore.getElementsByClassName("step_description")[0].textContent=l.instalacao?"c/Instala\xE7\xE3o":"s/Instala\xE7\xE3o"),e==="medidas"&&(h.length>0?u[e].getElementsByClassName("step_description")[0].innerHTML+=h[0].correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o":u[e].getElementsByClassName("step_description")[0].innerHTML+=l.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o",u.medidasEstore?.classList.remove("active"),u.medidasEstore?.classList.remove("next"),u.medidasEstore?.classList.add("done"),u.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),u.medidasEstore.getElementsByClassName("step_description")[0].textContent=`${v?.value} X ${I?.value}cm`,u.medidasEstore.getElementsByClassName("step_description")[0].innerHTML+=`${l.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o"}`),e==="tipo"&&(u[e].getElementsByClassName("step_description")[0].innerHTML+=`${l.bainha?"<br>c/Ba\xEDnha de Chumbo":"<br>s/Ba\xEDnha de Chumbo"}`)},S=e=>{u[e].classList.remove("next"),u[e].classList.add("active"),u[e].getElementsByClassName("step_number")[0].classList.add("active"),e==="instalacao"&&(u.instalacaoEstore?.classList.remove("next"),u.instalacaoEstore?.classList.add("active"),u.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.add("active")),e==="medidas"&&(u.medidasEstore?.classList.remove("next"),u.medidasEstore?.classList.add("active"),u.medidasEstore?.getElementsByClassName("step_number")[0].classList.add("active"))},$t=e=>{let t=e;if(t==="suporte"&&(t="calha"),u[t].classList.contains("active")&&(u[t].classList.remove("active"),u[t].getElementsByClassName("step_number")[0].classList.remove("active")),t==="instalacao"&&(u.instalacaoEstore?.classList.remove("active"),u.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),t==="medidas"&&(u.medidasEstore?.classList.remove("active"),u.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),!L||b())return B(t);u[t].classList.add("next"),u[t].querySelector("step_description")&&!u[t].querySelector("step_description")[0].classList.contains("next")&&u[t].querySelector("step_description")[0].classList.add("next"),t==="instalacao"&&u.instalacaoEstore?.classList.add("next"),t==="medidas"&&u.medidasEstore?.classList.add("next")},p=e=>{e&&w?.classList.contains("inactive")&&w.classList.remove("inactive"),e||w?.classList.contains("inactive")||w.classList.add("inactive")},ge=e=>{e.classList.add("active")},Ee=e=>{e.classList.remove("active")},R=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.add("selected"),t.classList.add("active"),s.classList.add("active")},_=e=>{let t=e.getElementsByTagName("h1")[0],s=e.getElementsByClassName("tecido_image_contain")[0];e.classList.remove("selected"),t.classList.remove("active"),s.classList.remove("active")},Tt=()=>{let e=document.querySelectorAll("[id^='inicio-card']");e.forEach(t=>{t.addEventListener("click",()=>{let s=t.getElementsByTagName("h1")[0].textContent;R(t,n.inicio),e.forEach(a=>{a!==t&&_(a)}),O(s),x(n.inicio,s),b()&&p(!0)})})},Ot=()=>{let e=document.querySelectorAll("[id^='tecido-card']"),t=document.querySelectorAll(".tecido_color");e.forEach(s=>{s.addEventListener("click",()=>{let a=Oe(s),o=gt(s),r=oe.find(c=>c.product===a),d=s.getElementsByClassName("tecido_color");if(t.forEach(c=>Ee(c)),R(s,n.tecido),e.forEach(c=>{c!==s&&_(c)}),r){for(let c=0;c<d.length;c++)d.item(c).id===`${r.color}`&&ge(d.item(c));f==="tecido"&&x(n.tecido,r.color),f==="calha"&&pe(r.color)}else d.length>0&&ge(d[0]),f==="tecido"&&o!==""&&x(n.tecido,`${o}`),f==="calha"&&o!==""&&pe(o);b()&&p(!0)})})},Ft=()=>{let e=document.querySelectorAll(".tecido_color");e.forEach(t=>{t.addEventListener("click",s=>{let a=s.currentTarget,o=a&&a.id;ge(a),e.forEach(E=>{E!==a&&Ee(E)});let r=o?o.split("-")[0]:"",d=oe.find(E=>E.product===r);d?d.color=`${o}`:oe.push({product:r,color:`${o}`});let c=a.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0];for(let E=0;E<e.length;E++)if(e[E].getAttribute("id")===o){let C=e[E].querySelector(".source");C?c.setAttribute("src",C.getAttribute("src")):c.setAttribute("src",e[E].getElementsByTagName("img")[0].getAttribute("src")),c.setAttribute("srcset","");break}return f==="calha"&&o!==""?pe(o):f==="tecido"&&o!==""?x(n.tecido,o):console.log("No color was stored")})})},_t=()=>{let e=document.querySelectorAll("[id^='tipo-card']");e.forEach(t=>{t.addEventListener("click",()=>{R(t,n.tipo),e.forEach(s=>{s!==t&&_(s)}),x(n.tipo,t.getElementsByTagName("h1")[0].textContent),b()&&p(!0)})})},At=()=>{Z.addEventListener("change",function(e){x(n.bainha,Z.checked)})},Nt=()=>{A?.addEventListener("change",e=>{(A?.checked===!0||q?.checked===!0)&&(Te("Parede"),b()&&p(!0))}),q?.addEventListener("change",e=>{(A?.checked===!0||q?.checked===!0)&&(Te("Tecto"),b()&&p(!0))})},Dt=()=>{v?.addEventListener("input",e=>{v?.value===""||I?.value===""||(b()&&x(n.medidas,`${v?.value} X ${I?.value}`),v?.value!==""&&I?.value!==""&&(b()?p(!0):p(!1)))}),I?.addEventListener("input",e=>{v?.value===""||I?.value===""||(b()&&x(n.medidas,`${v?.value} X ${I?.value}`),v?.value!==""&&I?.value!==""&&(b()?p(!0):p(!1)))})},zt=()=>{H.addEventListener("change",function(e){x(n.correcao,H.checked)})},Xt=()=>{U.addEventListener("change",function(e){x(n.instalacao,U.checked)})},Mt=()=>{Object.keys(u).forEach(e=>{u[e].addEventListener("click",()=>{vt(e)})})},Rt=()=>{Object.keys(W).forEach(e=>{W[e].addEventListener("click",()=>{e==="correcao"||e==="estoreCorrecao"||e!=="suporte"&&e!=="bainha"&&De(e)})})},Xe=e=>{e.button.addEventListener("click",()=>{Ne(e)})},Vt=()=>{j.addEventListener("click",async()=>{l.nome=me.value,l.email=he.value,l.contacto=Qe.checked;let e=await Pt(),t=await Wt();await Qt(l.nome,l.email,l.contacto,e,t)})},Ht=()=>{at.addEventListener("click",ht)},qt=()=>{ot.addEventListener("click",()=>{et.style.display="none",tt.style.display="flex"})},Ut=()=>{w.addEventListener("click",It)},wt=e=>{let t=g.usedWidths.find(s=>e.tipo===s.name);return t?(e.medidas?parseInt(e.medidas.split(" X ")[0]):0)*t.widthRatio+g.bainhaPrice.widthMargin:0},jt=(e,t)=>{let s=e.medidas.split(" X ")[0],a=0,o=0,r=lt(e);return e.inicio==="Cortina"&&(a=r.product*(t/100),o=r.calha),e.inicio==="Estore"&&(a=r.product),{product:a,calha:o}},Jt=(e,t)=>{if(e.inicio==="Estore")return 0;let s=g.manufacturingPrices.find(a=>e.tipo===a.name);return s?e.tecido.startsWith("8")?s.blackout*(t/100):e.tecido.startsWith("9")&&(e.tipo==="Ondas"||e.tipo==="Franzido")?s.alinhado*(t/100):s.normal*(t/100):0},Zt=(e,t)=>e.inicio==="Cortina"&&(e.tecido.startsWith("120")||e.tecido.startsWith("122"))||e.inicio==="Estore"?0:e.bainha?g.bainhaPrice.price*(t/100):0,fa=e=>e.correcao?g.measuresCheckPrice:0,Kt=e=>{if(!h[0].instalacao)return 0;let t=0,s=parseInt(e.medidas.split(" X ")[0]),a=g.instalation.find(o=>s<=o.maxWidth);return a&&(t=a.price),a&&e.inicio==="Cortina"&&e.calha.startsWith("9500")&&(t*=2),t||0},Me=e=>{let t=wt(e),s=jt(e,t),a=Jt(e,t),o=Zt(e,t),r=Kt(e),d=s.product+a+o+s.calha+r;return e.totalPrice=d,{tecido:s.product+a+o,calha:s.calha,instalacao:r,total:d}},Yt=e=>{let t=e.indexOf("@");return t>0&&t<e.length-1},Re=e=>new Promise((t,s)=>{let a=new FileReader;a.onloadend=()=>t(a.result),a.onerror=s,a.readAsDataURL(e)}),Gt=()=>{Y.textContent="",X.textContent="",$e.textContent="",Y.classList.remove("u-text-main"),X.classList.remove("u-text-main"),$e.classList.remove("u-text-main")},Qt=async(e,t,s,a,o)=>{let r=document.getElementById("feedback-div"),d=null,c=null,E=!1;Gt(),e.trim()===""&&(Y.textContent="Preencher este campo obrigat\xF3rio",Y.classList.add("u-text-main"),E=!0);let C=t.trim();if(C===""?(X.textContent="Preencher este campo obrigat\xF3rio",X.classList.add("u-text-main"),E=!0):Yt(C)||(X.textContent="Insira um email v\xE1lido",X.classList.add("u-text-main"),E=!0),!E){try{let k=await a,T=await o;d=await Re(k),c=await Re(T)}catch{console.error("Failed to load PDF"),d=null}let y={name:e,email:t,check:s,file:d,to_company_email:"contact@fabricstore.pt",to_user_email:t,reply_to:"general@brightweb.tech"},P={name:e,email:t,check:s,file:c,to_company_email:"contact@fabricstore.pt",reply_to:"general@brightweb.tech"};emailjs.send("service_fabricstore","template_quote_pdf",y).then(function(k){console.log("SUCCESS!",k.status,k.text),K.style.display="none",j.style.display="none",r.textContent="Obrigado pelo seu contacto!"},function(k){console.log("FAILED...",k),K.style.display="none",j.style.display="none",r.textContent="Oops! Algo correu mal!"}),emailjs.send("service_fabricstore","template_quote_txt",P).then(function(k){console.log("SUCCESS!",k.status,k.text),K.style.display="none",j.style.display="none",r.textContent="Obrigado pelo seu contacto!"},function(k){console.log("FAILED...",k),K.style.display="none",j.style.display="none",r.textContent="Oops! Algo correu mal!"})}},Ve={spaceBetween:12,allowTouchMove:!1,resistanceRatio:0,watchOverflow:!0,keyboard:{enabled:!0,onlyInViewport:!1},navigation:{nextEl:".slider-main_button.swiper-btn-next",prevEl:".slider-main_button.swiper-btn-prev"},breakpoints:{320:{slidesPerView:1},480:{slidesPerView:2},640:{slidesPerView:3},1024:{slidesPerView:6}}},He=new Swiper(".swiper",Ve),ga=()=>{He.destroy(),He=new Swiper(".swiper",Ve)},Ea=()=>{let e=125;for(let t=0;t<5;t++)e=125+t*125,h.push({inicio:"Cortina",tecido:"101015-003",tipo:"Ondas",medidas:`${e} X 250`,correcao:t%2!==0,calha:"5000-Branco",instalacao:t%2===0})},ya=()=>{h.push({inicio:"Cortina",tecido:"120100-008",tipo:"Franzido",medidas:"200 X 250",correcao:!0,calha:"5000-B",instalacao:!0})},xa=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];he.value="ritabreu@test.pt",me.value="Rita Abreu",h.push(...e)},Ca=()=>{let e=[{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"348 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];he.value="ritabreu@test.pt",me.value="Rita Abreu",h.push(...e)},ba=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"360 X 150",correcao:!1,calha:"5000-B",instalacao:!1}];h.push(...e)},Ba=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"350 X 240",correcao:!0,calha:"5000-B",instalacao:!0}];h.push(...e)};rt()});})();
