"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let be={spaceBetween:12,allowTouchMove:!1,resistanceRatio:0,watchOverflow:!0,keyboard:{enabled:!0,onlyInViewport:!1},navigation:{nextEl:".slider-main_button.swiper-btn-next",prevEl:".slider-main_button.swiper-btn-prev"},breakpoints:{320:{slidesPerView:1},480:{slidesPerView:2},640:{slidesPerView:3},1024:{slidesPerView:6}}},xe=new Swiper(".swiper",be),Jt=()=>{xe.destroy(),xe=new Swiper(".swiper",be)},ze="https://cdn.prod.website-files.com/66aadbd497db3d8c63799460/66eb5ac454e950633d646ea2_testlogo.jpg",N={},Zt={Branco:"B",Inox:"I",Bronze:"BZ",Preto:"P",Nogueira:"N",Chumbo:"CH"},T={estores:{width:[80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],height:[80,100,120,140,160,180,200,220,240,260,280,300,320]},calhas:{"5000-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"1500-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"9500M":[150,200,250,300,350,400,450,500,600,650,700,750,800,850,900,1e3,1200],KS:[160,200,240,300,400,500,600],"DSXL-B":[160,200,240,300,400,600],"DSXL-CZ":[160,200,240,300,400,600],"DSXL-P":[160,200,240,300,400,600]}},w=[],h=[],f="inicio",n={inicio:"",tecido:"",tipo:"",bainha:"",medidas:"",correcao:"",calha:"",suporte:"",instalacao:"",nome:"",email:"",contacto:""},g={usedWidths:[{name:"Franzido",widthRatio:2.5},{name:"Ondas",widthRatio:2.7},{name:"Macho Juntos",widthRatio:3},{name:"Pregas",widthRatio:2.5}],manufacturingPrices:[{name:"Franzido",blackout:9,normal:8},{name:"Ondas",blackout:8.5,normal:7.5},{name:"Macho Juntos",normal:13.5,blackout:13.5,alinhado:12.5},{name:"Pregas",normal:13.5,blackout:13.5,alinhado:12.5}],bainhaPrice:{price:3.5,widthMargin:20},uniao:{maxLength:400,price:8.6,calha9500M:15},prolongadores:3.7,roletesPrice:5,minWindowWidthEstores:80,maxWindowWidthEstores:300,minWindowHeightEstores:80,maxWindowHeightEstores:300,maxWindowWidth:650,maxWindowHeight:280,maxCalhaWidth:600,measuresCheckPrice:30,instalation:[{maxWidth:300,price:35},{maxWidth:400,price:40},{maxWidth:500,price:45},{maxWidth:600,price:50},{maxWidth:650,price:55}]},k=!0,Be=document.getElementById("sim-container"),ee=document.getElementById("steps-cortina"),te=document.getElementById("steps-estore"),m={step1:document.getElementById("simulator-heading-1"),step1i:document.getElementById("inicio-description"),step1c:document.getElementById("inicio-description-c"),step1e:document.getElementById("inicio-description-e"),step2:document.getElementById("simulator-heading-2"),step3:document.getElementById("simulator-heading-3"),step4:document.getElementById("simulator-heading-4"),step5:document.getElementById("simulator-heading-5")},c={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),suporte:document.getElementById("suporte-selector"),instalacao:document.getElementById("instalacao-selector")},ve=document.getElementById("largura-input-descr-c"),Ie=document.getElementById("altura-input-descr-c"),ke=document.getElementById("largura-input-descr-e"),Pe=document.getElementById("altura-input-descr-e"),B=document.getElementById("largura-input"),v=document.getElementById("altura-input"),R=document.querySelector("#correcao-switch"),j=document.querySelector("#bainha"),z=document.getElementById("tecto-radio-btn"),F=document.getElementById("parede-radio-btn"),H=document.querySelector("#instalacao-switch"),ae=document.getElementById("largura-min-error-estore"),oe=document.getElementById("altura-min-error-estore"),se=document.getElementById("largura-max-error-estore"),ie=document.getElementById("altura-max-error-estore"),ce=document.getElementById("largura-error"),ne=document.getElementById("altura-error"),q=document.getElementById("seguinte-btn"),r={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao"),medidasEstore:document.getElementById("step-medidas-estore"),instalacaoEstore:document.getElementById("step-instalacao-estore")},J=document.getElementById("form"),re=document.getElementById("nome-input"),le=document.getElementById("email-input"),He=document.getElementById("contacto-switch"),Le=document.getElementById("checkout-container"),qe=document.getElementById("new-window-contain"),Ue=document.getElementById("checkout-input-contain"),We=document.getElementById("checkout-info-estore"),Se=document.getElementById("checkout-info-cortina"),je=document.getElementById("new-window-btn"),Je=document.getElementById("no-window-btn"),U=document.getElementById("enviar-btn"),L={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),bainha:document.getElementById("checkout-bainha"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),suporte:document.getElementById("checkout-suporte"),instalacao:document.getElementById("checkout-instalacao"),estoreProduto:document.getElementById("checkout-produto-estore"),estoreLargura:document.getElementById("checkout-largura-estore"),estoreAltura:document.getElementById("checkout-altura-estore"),estoreCorrecao:document.getElementById("checkout-correcao-estore"),estoreInstalacao:document.getElementById("checkout-instalacao-estore")},Kt=document.getElementById("feedback-div"),Z=document.getElementById("name-error"),X=document.getElementById("email-error"),$e=document.getElementById("contacto-switch-error"),Ze=document.getElementById("cortina-radio-btn"),Ke=document.getElementById("estore-radio-btn"),Ge=document.getElementById("calha-radio-btn"),Qe=()=>{At(),Bt(),vt(),kt(),Pt(),St(),$t(),It(),_t(),Ft(),Nt(),Tt(),Ot(),Wt(),Lt()},Ye=()=>{et(),Qe()},we=e=>{let t=0,a=0,s="",o=e.tecido.split("-"),u=o[0],d=o[1],l=e.calha?e.calha.split("-"):null,E=l?l[0]:null,C=l?l[1]:null,P=e.medidas?e.medidas.split(" X ")[0]:0;if(e.inicio==="Cortina"&&(s=`${u}${d}`),e.inicio==="Estore"){let D=e.medidas?e.medidas.split(" X ")[1]:0;s=st(u,d,P,D)}if(t=typeof N[s].price=="string"?parseFloat(N[s].price):N[s].price,e.inicio==="Estore")return{product:t,calha:0};let S=(P/g.maxCalhaWidth|0)+1,I=P<=g.maxCalhaWidth?P:P/S,O=it(E,e.tipo,C,I,e?.suporte==="Parede");return a=N[O]?P<g.maxCalhaWidth?N[O].price:N[O].price*S:0,a+=P>g.maxCalhaWidth?g.prolongadores*S:P>g.uniao.maxLength&&e.calha.startsWith("9500M")?g.uniao.calha9500M*S:P>g.uniao.maxLength?g.uniao.price*S:0,(O.startsWith("5000")||O.startsWith("1500"))&&(a+=P<g.maxCalhaWidth?g.roletesPrice:g.roletesPrice*S),{product:t,calha:a}},et=()=>{fetch("https://docs.google.com/spreadsheets/d/e/2PACX-1vSCprbghTI2dhOxsCMkcEHhI-DE5pOb5RnOKO3KPd5-ntAORtuPTuFonSvs9s4-ANy_VCezuEdcZ8pg/pub?gid=0&single=true&output=csv").then(e=>e.text()).then(e=>{let t=e.trim().split(`
`),a=t[0].split(","),s=t.slice(1).map(u=>u.split(",")),o={};s.forEach(u=>{let[d,l]=u;o[d]||(o[d]={id:d,price:parseFloat(l)})}),N=o}).catch(e=>console.error("Error fetching CSV data:",e))},y=(e,t)=>{n[e.id.split("-")[0]]=t},de=e=>{n.calha=e},Oe=e=>{n.suporte=F.checked?"Parede":"Tecto"},tt=()=>{n.inicio="",n.tecido="",n.tipo="",n.bainha="",n.medidas="",n.correcao="",n.calha="",n.suporte="",n.instalacao=""},at=e=>{e.inicio==="Cortina"&&(y(c.inicio,"Cortina"),y(c.tecido,e.tecido),y(c.tipo,e.tipo),y(c.bainha,e.bainha),y(c.medidas,e.medidas),y(c.correcao,e.correcao),y(c.suporte,e.suporte),y(c.instalacao,e.instalacao)),e.inicio==="Estore"&&(y(c.inicio,"Estore"),y(c.tecido,e.tecido),y(c.medidas,e.medidas),y(c.correcao,e.correcao),y(c.instalacao,e.instalacao))},ue=()=>{let e={inicio:n.inicio,bainha:n.bainha,tecido:n.tecido,tipo:n.tipo,medidas:n.medidas,correcao:n.correcao,calha:n.calha,suporte:n.suporte,instalacao:n.instalacao};h.push(e),k=!1},ot=()=>{A("Cortina"),tt(),rt(),De("inicio"),k=!0},b=()=>{switch(f){case"inicio":return n.inicio===""?(p(!1),!1):(p(!0),!0);case"tecido":return n.tecido===""?(p(!1),!1):(p(!0),!0);case"tipo":return n.tipo===""?(p(!1),!1):(p(!0),!0);case"medidas":return B?.value===""||v?.value===""?(alert("Preencha valores v\xE1lidos de largura e altura"),p(!1),!1):n.inicio==="Cortina"?parseInt(B?.value)>g.maxWindowWidth||parseInt(v?.value)>g.maxWindowHeight?(parseInt(B?.value)>g.maxWindowWidth?ce.style.display="block":ce.style.display="none",parseInt(v?.value)>g.maxWindowHeight?ne.style.display="block":ne.style.display="none",p(!1),!1):(p(!0),!0):n.inicio==="Estore"?parseInt(B?.value)<g.minWindowWidthEstores||parseInt(v?.value)<g.minWindowHeightEstores?(parseInt(B?.value)<g.minWindowWidthEstores?ae.style.display="block":ae.style.display="none",parseInt(v?.value)<g.minWindowHeightEstores?oe.style.display="block":oe.style.display="none",p(!1),!1):parseInt(B?.value)>g.maxWindowWidthEstores||parseInt(v?.value)>g.maxWindowHeightEstores?(parseInt(B?.value)>g.maxWindowWidthEstores?se.style.display="block":se.style.display="none",parseInt(v?.value)>g.maxWindowHeightEstores?ie.style.display="block":ie.style.display="none",p(!1),!1):(p(!0),!0):(ce.style.display="none",ne.style.display="none",ae.style.display="none",oe.style.display="none",se.style.display="none",ie.style.display="none",p(!0),!0);case"calha":return n.calha===""?(p(!1),!1):(p(!0),!0);case"suporte":return n.suporte===""?(p(!1),!1):(p(!0),!0)}return p(!0),!0},st=(e,t,a,s)=>{let o=T.estores.width.find(d=>d>=a),u=T.estores.height.find(d=>d>=s);return`${e}${u}${o}`},it=(e,t,a,s,o)=>{if(e==="KS"){if(o){let l=T.calhas[e]?.find(E=>E>=s);return`${e}${t==="Franzido"?"F":"O"}${l}SP`}let d=T.calhas[e]?.find(l=>l>=s);return`${e}${t==="Franzido"?"F":"O"}${d}`}if(e==="DSXL"){if(o){let l=T.calhas[`${e}-${a}`]?.find(E=>E>=s);return`${e}${t==="Franzido"?"F":"O"}${l}${a}SP`}let d=T.calhas[`${e}-${a}`]?.find(l=>l>=s);return`${e}${t==="Franzido"?"F":"O"}${d}${a}`}if(e==="9500M"){if(o){let l=T.calhas[e].find(E=>E>=s);return`${e}${l}SP`}let d=T.calhas[e].find(l=>l>=s);return`${e}${d}`}if(o){let d=T.calhas[`${e}-${a}`].find(l=>l>=s);return`${e}${d}${a}SP`}let u=T.calhas[`${e}-${a}`].find(d=>d>=s);return`${e}${u}${a}`},ct=e=>{let t=e.getElementsByClassName("color_name");return t.length>0?t[0].textContent:null},Te=e=>{let t=e.getElementsByClassName("product_name");return t.length>0?t[0].textContent:null},nt=e=>{switch(e){case"tecido":case"inicio":return"step1";case"tipo":case"bainha":return"step2";case"medidas":case"correcao":return"step3";case"calha":return"step4";case"instalacao":return"step5"}},A=e=>{e==="Estore"&&Ke?.click(),e==="Cortina"&&Ze?.click(),e==="Calha"&&Ge?.click()},rt=()=>{let e=document.querySelectorAll("[id^='inicio-card']"),t=document.querySelectorAll("[id^='tipo-card']"),a=document.querySelectorAll("[id^='tecido-card']"),s=document.querySelectorAll(".tecido_color");e.forEach(o=>{_(o)}),t.forEach(o=>{_(o)}),a.forEach(o=>{_(o)}),s.forEach(o=>{he(o)}),B.value="",v.value="",R.checked=!1,H.checked=!1,F?.click(),j.checked=!1},_e=e=>{document.querySelectorAll("[id^='inicio-card']").forEach(a=>{a.getElementsByTagName("h1")[0].textContent===e?V(a):_(a)})},Fe=e=>{document.querySelectorAll("[id^='tecido-card']").forEach(a=>{Te(a).startsWith(e)?V(a):_(a)})},lt=e=>{document.querySelectorAll("[id^='tipo-card']").forEach(a=>{a.getElementsByTagName("h1")[0].textContent===e?V(a):_(a)})},dt=e=>{e==="Parede"?F.click():z.click()},ut=()=>{z.checked=!1,F.checked=!1},K=()=>{let e=document.querySelector("#checkout-window-btn"),t=document.getElementById("window-btns-container");if(h.length===1&&(h[0].button=e,Xe(h[0])),h.length>1&&e){let a=e.cloneNode(!0);a.querySelector(".checkout_info_title").textContent=`Janela ${h.length}`,h[h.length-1].button=a,Xe(h[h.length-1]),t?.appendChild(a)}},mt=e=>{e.inicio==="Cortina"&&(_e(e.inicio),Fe(e.tecido),lt(e.tipo),j.checked=e.bainha,B.value=e.medidas.split(" X ")[0],v.value=e.medidas.split(" X ")[1],R.checked=e.correcao,dt(e.suporte),H.checked=e.instalacao),e.inicio==="Estore"&&(_e(e.inicio),Fe(e.tecido),B.value=e.medidas.split(" X ")[0],v.value=e.medidas.split(" X ")[1],R.checked=e.correcao,H.checked=e.instalacao)},G=e=>{e==="inicio"&&(m.step1i.style.display="flex",m.step1c.style.display="none",m.step1e.style.display="none"),e==="tecido"&&n.inicio==="Cortina"&&(m.step1i.style.display="none",m.step1c.style.display="flex",m.step1e.style.display="none"),e==="tecido"&&n.inicio==="Estore"&&(m.step1i.style.display="none",m.step1c.style.display="none",m.step1e.style.display="flex")},ht=e=>{if((e==="largura"||e==="altura")&&(e="medidas"),e===f)return;let t=!1;if((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto"||e==="medidasEstore")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura"||e==="medidasEstore")&&(e="medidas"),e==="estoreCorrecao"&&(e="correcao"),e==="estoreInstalacao"&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),r[e].classList.contains("done")){switch(xt(f),i(m[nt(f)],!1),i(f==="calha"?c.tecido:c[f],!1),G(e),e){case"tecido":i(m.step1,!0),i(c.tecido,!0);break;case"tipo":i(m.step2,!0),i(c.tipo,!0);break;case"medidas":i(m.step3,!0),i(c.medidas,!0);break;case"calha":i(m.step4,!0),i(c.tecido,!0);break;case"instalacao":i(m.step5,!0),i(c.instalacao,!0);break}f=e,b(),$(e)}},Ne=()=>{n.inicio==="Cortina"&&(ve.style.display="block",Ie.style.display="block",ke.style.display="none",Pe.style.display="none"),n.inicio==="Estore"&&(ve.style.display="none",Ie.style.display="none",ke.style.display="block",Pe.style.display="block")},pt=()=>{if(n.inicio==="Cortina")switch(f){case"inicio":b()&&(M("Cortina"),i(c.inicio,!1),G("tecido"),k&&p(!1),i(c.tecido,!0),f="tecido");break;case"tecido":b()&&(G("tecido"),x("tecido"),$("tipo"),i(m.step1,!1),k&&p(!1),i(c.tecido,!1),i(m.step2,!0),i(c.tipo,!0),Ne(),f="tipo");break;case"tipo":b()&&(i(c.tipo,!1),n.tecido.startsWith("120")||n.tecido.startsWith("122")?(y(c.bainha,!0),k&&p(!1),x("tipo"),$("medidas"),i(m.step2,!1),i(m.step3,!0),i(c.medidas,!0),f="medidas"):(i(c.bainha,!0),f="bainha"));break;case"bainha":y(c.bainha,`${n.tecido.startsWith("120")||n.tecido.startsWith("122")?!0:n.bainha?n.bainha:!1}`),x("tipo"),$("medidas"),i(m.step2,!1),i(c.bainha,!1),k&&p(!1),i(m.step3,!0),i(c.medidas,!0),f="medidas";break;case"medidas":b()&&(y(c.medidas,`${B?.value} X ${v?.value}`),i(c.medidas,!1),h.length>0?(k&&p(!1),A("Calha"),x("medidas"),$("calha"),i(m.step3,!1),i(m.step4,!0),i(c.tecido,!0),f="calha"):(i(c.correcao,!0),f="correcao"));break;case"correcao":A("Calha"),x("medidas"),$("calha"),i(m.step3,!1),i(c.correcao,!1),k&&p(!1),i(m.step4,!0),i(c.tecido,!0),f="calha";break;case"calha":b()&&(i(c.tecido,!1),k&&p(!1),ut(),i(c.suporte,!0),f="suporte");break;case"suporte":y(c.suporte,F?.checked?"Parede":"Tecto"),b()&&(x("calha"),$("instalacao"),i(m.step4,!1),i(c.suporte,!1),h.length>0?(k&&(ue(),K()),Q()):(i(m.step5,!0),i(c.instalacao,!0),f="instalacao"));break;case"instalacao":x("instalacao"),i(m.step5,!1),i(c.instalacao,!1),k&&(ue(),K()),Q();break}else switch(f){case"inicio":b()&&(M("Estore"),i(c.inicio,!1),G("tecido"),k&&p(!1),i(c.tecido,!0),f="tecido");break;case"tecido":b()&&(x("tecido"),$("medidas"),i(m.step1,!1),i(c.tecido,!1),Ne(),k&&p(!1),i(m.step3,!0),i(c.medidas,!0),f="medidas");break;case"medidas":b()&&(i(c.medidas,!1),h.length>0?(x("medidas"),$("instalacao"),i(m.step3,!1),i(m.step5,!0),i(c.instalacao,!0),f="instalacao"):(i(c.correcao,!0),f="correcao"));break;case"correcao":x("medidas"),$("instalacao"),i(m.step3,!1),i(c.correcao,!1),h.length>0?(K(),Q()):(i(m.step5,!0),i(c.instalacao,!0),f="instalacao");break;case"instalacao":x("instalacao"),i(m.step5,!1),i(c.instalacao,!1),k&&(ue(),K()),Q();break}},Q=()=>{Be.style.display="none",Ae(h[h.length-1]),M(),Le.style.display="flex"},ft=e=>{e.inicio==="Cortina"&&(We.style.display="none",Se.style.display="flex",L.tecido.textContent=e.tecido,L.tipo.textContent=e.tipo,L.bainha.textContent=e.tipo==="Ondas"||e.tipo==="Franzido"?"Ba\xEDnha de Chumbo inclu\xEDda":e.bainha?"Com Ba\xEDnha de Chumbo":"Sem Ba\xEDnha de Chumbo",L.largura.textContent=e.medidas.split(" X ")[0]+"cm Largura",L.altura.textContent=e.medidas.split(" X ")[1]+"cm Altura",L.correcao.textContent=h[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",L.calha.textContent=e.calha,L.suporte.textContent="Suporte de "+e.suporte,L.instalacao.textContent=h[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"),e.inicio==="Estore"&&(We.style.display="flex",Se.style.display="none",L.estoreProduto.textContent=e.tecido,L.estoreLargura.textContent=e.medidas.split(" X ")[0]+"cm",L.estoreAltura.textContent=e.medidas.split(" X ")[1]+"cm",L.estoreCorrecao.textContent=h[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",L.estoreInstalacao.textContent=h[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o")},gt=e=>{e.inicio==="Cortina"&&(x("tecido"),x("tipo"),x("medidas"),x("calha"),x("instalacao")),e.inicio==="Estore"&&(x("tecido"),x("medidasEstore"),x("instalacaoEstore"))},Ae=e=>{h.forEach(t=>{t.button&&t.button.classList.remove("active")}),e.button.classList.add("active"),ft(e),mt(e),at(e),gt(e)},De=e=>{Le.style.display="none",k&&bt(),M(),Be.style.display="flex";let t=!1;switch((e==="estoreLargura"||e==="estoreAltura"||e==="estoreCorrecao"||e==="estoreInstalacao"||e==="estoreProduto")&&(t=!0),(e==="largura"||e==="altura"||e==="estoreLargura"||e==="estoreAltura")&&(e="medidas"),e==="estoreCorrecao"&&(e="correcao"),e==="estoreInstalacao"&&(e="instalacao"),e==="estoreProduto"&&(e="tecido"),M(t?"Estore":"Cortina"),e){case"inicio":i(m.step1,!0),i(c.inicio,!0);break;case"tecido":A(t?"Estore":"Cortina"),i(m.step1,!0),i(c.tecido,!0);break;case"tipo":i(m.step2,!0),i(c.tipo,!0);break;case"medidas":i(m.step3,!0),i(c.medidas,!0);break;case"calha":A("Calha"),i(m.step4,!0),i(c.tecido,!0);break;case"suporte":i(m.step4,!0),i(c.suporte,!0);break;case"instalacao":i(m.step5,!0),i(c.instalacao,!0);break}if(f=e,f==="inicio")return $("tecido");k=!1},Gt=async e=>{let t=Buffer.from(e,"base64"),s=await(await PDFDocument.load(t)).save();return Buffer.from(s).toString("base64")},Qt=async e=>await(await fetch(e)).arrayBuffer(),Et=async()=>{let{PDFDocument:e,rgb:t}=PDFLib,a=await e.create(),s=a.addPage([595.28,841.89]),o=800,u=50,d=545,l=12,E=0,C=await a.embedFont(PDFLib.StandardFonts.HelveticaBold),P=null;try{P=await Ct(ze);let W=await fetch(P).then(ye=>ye.arrayBuffer()),fe=await a.embedPng(W),Y=200,ge=30,Ee=(s.getWidth()-Y)/2;s.drawImage(fe,{x:Ee,y:o-50,width:Y,height:ge})}catch(W){console.error("Error loading logo:",W)}o-=60,s.drawText(`Data: ${new Date().toLocaleDateString()}`,{x:d-90,y:o,size:10,font:C}),s.drawText(`Cliente: ${n.nome}`,{x:u,y:o,size:10,font:C}),o-=l,s.drawText(`Email: ${n.email}`,{x:u,y:o,size:10,font:C}),o-=30,h.forEach((W,fe)=>{if(o<100){let Ce=a.addPage([595.28,841.89]);o=800}let{usedWidth:Y,productPrice:ge,manufacturingPrice:Ee,bainhaPrice:ye,calhaPrice:Ut,instalationPrice:jt,windowTotal:Re}=Me(W);E+=Re,s.drawText(`Janela ${fe+1} - ${W.medidas} CM - (Largura Utilizada: ${parseInt(parseFloat(Y).toFixed(2))} CM)`,{x:u,y:o,size:10,font:C}),s.drawText(`${Re.toFixed(2)}\u20AC`,{x:d-100,y:o,size:10,font:C}),o-=l,[{label:`Tecido: ${W.tecido}`,price:ge},{label:`Tipo de Cortina: ${W.tipo}`,price:Ee},{label:`Ba\xEDnha de Chumbo: ${W.tecido.startsWith("120")||W.tecido.startsWith("122")?"Inclu\xEDda":W.bainha?"Sim":"N\xE3o"}`,price:ye},{label:`Calha: ${W.calha} - Suporte: Suporte de ${W.suporte}`,price:Ut},{label:`Instala\xE7\xE3o: ${h[0].instalacao?"Sim":"N\xE3o"}`,price:jt}].forEach(Ce=>{s.drawText(`  - ${Ce.label}`,{x:u+10,y:o,size:8,font:C}),s.drawText(`${Ce.price.toFixed(2)}\u20AC`,{x:d-100,y:o,size:8,font:C}),o-=l}),o-=l});let S=h[0].correcao?"Com corre\xE7\xE3o de medidas":"Medidas facultadas pelo cliente";s.drawText(`Corre\xE7\xE3o: ${S}`,{x:u,y:o,size:10,font:C});let I=h[0].correcao?30:0;E+=I,s.drawText(`${I.toFixed(2)}\u20AC`,{x:d-100,y:o,size:10,font:C}),o-=l*2,s.drawText("Total:",{x:d-150,y:o,size:12,font:C}),s.drawText(`${E.toFixed(2)}\u20AC`,{x:d-100,y:o,size:12,font:C}),o-=l*4,s.drawText("Valores com IVA incluido \xE0 taxa em vigor. Or\xE7amento v\xE1lido por 15 dias.",{x:u,y:o,size:8,font:C}),o-=l,s.drawText("Calhas j\xE1 incluem os rod\xEDzios e suportes necess\xE1rios para as medidas selecionadas.",{x:u,y:o,size:8,font:C}),o-=l,s.drawText("Valor referente \xE0 instala\xE7\xE3o e Rectifica\xE7\xE3o de Medidas sujeito a valida\xE7\xE3o do c\xF3digo postal.",{x:u,y:o,size:8,font:C}),o-=l,s.drawText("IBAN: PT50 0000 0000 0000 0000 0",{x:u,y:o,size:8,font:C});let O=await a.save(),D=new Blob([O],{type:"application/pdf"}),pe=document.createElement("a");return pe.href=URL.createObjectURL(D),pe.download="Orcamento_Fabric-Store.pdf",pe.click(),D},yt=async()=>{let e=0,t="";t+=`Data: ${new Date().toLocaleDateString()}

`,t+=`Cliente: ${n.nome}

`,t+=`Email: ${n.email}

`;let a=h[0].correcao?"  Com corre\xE7\xE3o de medidas:":"  Medidas facultadas pelo cliente:",s=h[0].correcao?30:0;h.forEach((d,l)=>{let{usedWidth:E,productPrice:C,manufacturingPrice:P,bainhaPrice:S,calhaPrice:I,instalationPrice:O,windowTotal:D}=Me(d);e+=D,t+=`Janela ${l+1} - ${d.medidas} CM - (Largura Utilizada: ${parseInt(parseFloat(E).toFixed(2))} CM): ${D.toFixed(2)}\u20AC

`,t+=`  Pre\xE7o do Produto: ${C.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o de Fabrica\xE7\xE3o: ${P.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o da Bainha: ${S.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o da Calha: ${I.toFixed(2)}\u20AC
`,t+=`  Pre\xE7o da Instala\xE7\xE3o: ${O.toFixed(2)}\u20AC

`}),t+=`Corre\xE7\xE3o:
${a} ${s.toFixed(2)}\u20AC

`,e+=s,t+=`Total: ${e.toFixed(2)}\u20AC

`;let o=new Blob([t],{type:"text/plain"}),u=document.createElement("a");return u.href=URL.createObjectURL(o),u.download="Orcamento_Fabric-Store.txt",u.click(),o},Ct=e=>new Promise((t,a)=>{let s=new Image;s.crossOrigin="Anonymous",s.src=e,s.onload=()=>{let o=document.createElement("canvas");o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0);let d=o.toDataURL("image/png");t(d)},s.onerror=o=>{a(new Error(`Failed to load image from ${e}: ${o.message}`))}}),Yt=e=>{e.classList.add("show"),gsap.fromTo(e,{opacity:0},{opacity:1,duration:1,ease:"power1.in"})},M=e=>{e||(ee.style.display="none",te.style.display="none"),e==="Cortina"&&(ee.style.display="flex",te.style.display="none"),e==="Estore"&&(ee.style.display="none",te.style.display="flex")},i=(e,t)=>{e.style.display=t?"flex":"none"},bt=()=>{Object.keys(r).forEach(e=>{r[e].classList.remove("active"),r[e].classList.add("next"),r[e].classList.remove("done"),r[e].getElementsByClassName("step_number")[0].classList.remove("active"),r[e].getElementsByClassName("step_description")[0].textContent="Escolha"})},x=e=>{r[e].classList.remove("active"),r[e].classList.remove("next"),r[e].classList.add("done"),r[e].getElementsByClassName("step_number")[0].classList.remove("active"),r[e].getElementsByClassName("step_description")[0].classList.contains("next")&&r[e].getElementsByClassName("step_description")[0].classList.remove("next"),r[e].getElementsByClassName("step_description")[0].textContent=n[e],e==="instala\xE7\xE3o"&&(r.instalacaoEstore?.classList.remove("active"),r.instalacaoEstore?.classList.remove("next"),r.instalacaoEstore?.classList.add("done"),r.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),r.instalacaoEstore.getElementsByClassName("step_description")[0].textContent=n.instalacao?"c/Instala\xE7\xE3o":"s/Instala\xE7\xE3o"),e==="medidas"&&(h.length>0?r[e].getElementsByClassName("step_description")[0].innerHTML+=h[0].correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o":r[e].getElementsByClassName("step_description")[0].innerHTML+=n.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o",r.medidasEstore?.classList.remove("active"),r.medidasEstore?.classList.remove("next"),r.medidasEstore?.classList.add("done"),r.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active"),r.medidasEstore.getElementsByClassName("step_description")[0].textContent=`${B?.value} X ${v?.value}cm`,r.medidasEstore.getElementsByClassName("step_description")[0].innerHTML+=`${n.correcao?"<br>c/Verifica\xE7\xE3o":"<br>s/Verifica\xE7\xE3o"}`),e==="tipo"&&(r[e].getElementsByClassName("step_description")[0].innerHTML+=`${n.bainha?"<br>c/Ba\xEDnha de Chumbo":"<br>s/Ba\xEDnha de Chumbo"}`)},$=e=>{r[e].classList.remove("next"),r[e].classList.add("active"),r[e].getElementsByClassName("step_number")[0].classList.add("active"),e==="instalacao"&&(r.instalacaoEstore?.classList.remove("next"),r.instalacaoEstore?.classList.add("active"),r.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.add("active")),e==="medidas"&&(r.medidasEstore?.classList.remove("next"),r.medidasEstore?.classList.add("active"),r.medidasEstore?.getElementsByClassName("step_number")[0].classList.add("active"))},xt=e=>{let t=e;if(t==="suporte"&&(t="calha"),r[t].classList.contains("active")&&(r[t].classList.remove("active"),r[t].getElementsByClassName("step_number")[0].classList.remove("active")),t==="instalacao"&&(r.instalacaoEstore?.classList.remove("active"),r.instalacaoEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),t==="medidas"&&(r.medidasEstore?.classList.remove("active"),r.medidasEstore?.getElementsByClassName("step_number")[0].classList.remove("active")),!k||b())return x(t);r[t].classList.add("next"),r[t].querySelector("step_description")&&!r[t].querySelector("step_description")[0].classList.contains("next")&&r[t].querySelector("step_description")[0].classList.add("next"),t==="instalacao"&&r.instalacaoEstore?.classList.add("next"),t==="medidas"&&r.medidasEstore?.classList.add("next")},p=e=>{e&&q?.classList.contains("inactive")&&q.classList.remove("inactive"),e||q?.classList.contains("inactive")||q.classList.add("inactive")},me=e=>{e.classList.add("active")},he=e=>{e.classList.remove("active")},V=e=>{let t=e.getElementsByTagName("h1")[0],a=e.getElementsByClassName("tecido_image_contain")[0];e.classList.add("selected"),t.classList.add("active"),a.classList.add("active")},_=e=>{let t=e.getElementsByTagName("h1")[0],a=e.getElementsByClassName("tecido_image_contain")[0];e.classList.remove("selected"),t.classList.remove("active"),a.classList.remove("active")},Bt=()=>{let e=document.querySelectorAll("[id^='inicio-card']");e.forEach(t=>{t.addEventListener("click",()=>{let a=t.getElementsByTagName("h1")[0].textContent;V(t,c.inicio),e.forEach(s=>{s!==t&&_(s)}),A(a),y(c.inicio,a),b()&&p(!0)})})},vt=()=>{let e=document.querySelectorAll("[id^='tecido-card']"),t=document.querySelectorAll(".tecido_color");e.forEach(a=>{a.addEventListener("click",()=>{let s=Te(a),o=ct(a),u=w.find(l=>l.product===s),d=a.getElementsByClassName("tecido_color");if(t.forEach(l=>he(l)),V(a,c.tecido),e.forEach(l=>{l!==a&&_(l)}),u){for(let l=0;l<d.length;l++)d.item(l).id===`${u.color}`&&me(d.item(l));f==="tecido"&&y(c.tecido,u.color),f==="calha"&&de(u.color)}else d.length>0&&me(d[0]),f==="tecido"&&o!==""&&y(c.tecido,`${o}`),f==="calha"&&o!==""&&de(o);b()&&p(!0)})})},It=()=>{let e=document.querySelectorAll(".tecido_color");e.forEach(t=>{t.addEventListener("click",a=>{let s=a.currentTarget,o=s&&s.id;me(s),e.forEach(E=>{E!==s&&he(E)});let u=o?o.split("-")[0]:"",d=w.find(E=>E.product===u);d?d.color=`${o}`:w.push({product:u,color:`${o}`});let l=s.parentElement.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0];for(let E=0;E<e.length;E++)if(e[E].getAttribute("id")===o){let C=e[E].querySelector(".source");C?l.setAttribute("src",C.getAttribute("src")):l.setAttribute("src",e[E].getElementsByTagName("img")[0].getAttribute("src")),l.setAttribute("srcset","");break}return f==="calha"&&o!==""?de(o):f==="tecido"&&o!==""?y(c.tecido,o):console.log("No color was stored")})})},kt=()=>{let e=document.querySelectorAll("[id^='tipo-card']");e.forEach(t=>{t.addEventListener("click",()=>{V(t,c.tipo),e.forEach(a=>{a!==t&&_(a)}),y(c.tipo,t.getElementsByTagName("h1")[0].textContent),b()&&p(!0)})})},Pt=()=>{j.addEventListener("change",function(e){y(c.bainha,j.checked)})},Lt=()=>{F?.addEventListener("change",e=>{(F?.checked===!0||z?.checked===!0)&&(Oe("Parede"),b()&&p(!0))}),z?.addEventListener("change",e=>{(F?.checked===!0||z?.checked===!0)&&(Oe("Tecto"),b()&&p(!0))})},Wt=()=>{B?.addEventListener("input",e=>{B?.value===""||v?.value===""||(b()&&y(c.medidas,`${B?.value} X ${v?.value}`),B?.value!==""&&v?.value!==""&&(b()?p(!0):p(!1)))}),v?.addEventListener("input",e=>{B?.value===""||v?.value===""||(b()&&y(c.medidas,`${B?.value} X ${v?.value}`),B?.value!==""&&v?.value!==""&&(b()?p(!0):p(!1)))})},St=()=>{R.addEventListener("change",function(e){y(c.correcao,R.checked)})},$t=()=>{H.addEventListener("change",function(e){y(c.instalacao,H.checked)})},Ot=()=>{Object.keys(r).forEach(e=>{r[e].addEventListener("click",()=>{ht(e)})})},Tt=()=>{Object.keys(L).forEach(e=>{L[e].addEventListener("click",()=>{e==="correcao"||e==="estoreCorrecao"||De(e)})})},Xe=e=>{e.button.addEventListener("click",()=>{Ae(e)})},_t=()=>{U.addEventListener("click",async()=>{n.nome=re.value,n.email=le.value,n.contacto=He.checked;let e=await Et(),t=await yt();await qt(n.nome,n.email,n.contacto,e,t)})},Ft=()=>{je.addEventListener("click",ot)},Nt=()=>{Je.addEventListener("click",()=>{qe.style.display="none",Ue.style.display="flex"})},At=()=>{q.addEventListener("click",pt)},Dt=e=>{let t=g.usedWidths.find(a=>e.tipo===a.name);return t?(e.medidas?parseInt(e.medidas.split(" X ")[0]):0)*t.widthRatio+g.bainhaPrice.widthMargin:0},Xt=(e,t)=>{let a=e.medidas.split(" X ")[0],s=0,o=0,u=we(e);return e.inicio==="Cortina"&&(s=u.product*(t/100),o=u.calha),e.inicio==="Estore"&&(s=u.product),{product:s,calha:o}},Mt=(e,t)=>{if(e.inicio==="Estore")return 0;let a=g.manufacturingPrices.find(s=>e.tipo===s.name);return a?e.tecido.startsWith("101")?a.blackout*(t/100):(e.tecido.startsWith("120")||e.tecido.startsWith("122"))&&(e.tipo==="Ondas"||e.tipo==="Franzido")?a.alinhado*(t/100):a.normal*(t/100):0},Vt=(e,t)=>e.inicio==="Cortina"&&(e.tecido.startsWith("120")||e.tecido.startsWith("122"))||e.inicio==="Estore"?0:e.bainha?g.bainhaPrice.price*(t/100):0,wt=e=>e.correcao?g.measuresCheckPrice:0,Rt=e=>{if(!h[0].instalacao)return 0;let t=0,a=parseInt(e.medidas.split(" X ")[0]),s=g.instalation.find(o=>a<=o.maxWidth);return s&&(t=s.price),s&&e.inicio==="Cortina"&&e.calha.startsWith("9500")&&(t*=2),t||0},Me=e=>{let t=Dt(e),a=Xt(e,t),s=Mt(e,t),o=Vt(e,t),u=Rt(e),d=a.product+s+o+a.calha+u;return e.totalPrice=d,{usedWidth:t,productPrice:a.product,manufacturingPrice:s,bainhaPrice:o,calhaPrice:a.calha,instalationPrice:u,windowTotal:d}},zt=e=>{let t=e.indexOf("@");return t>0&&t<e.length-1},Ve=e=>new Promise((t,a)=>{let s=new FileReader;s.onloadend=()=>t(s.result),s.onerror=a,s.readAsDataURL(e)}),Ht=()=>{Z.textContent="",X.textContent="",$e.textContent="",Z.classList.remove("u-text-main"),X.classList.remove("u-text-main"),$e.classList.remove("u-text-main")},qt=async(e,t,a,s,o)=>{let u=document.getElementById("feedback-div"),d=null,l=null,E=!1;Ht(),e.trim()===""&&(Z.textContent="Preencher este campo obrigat\xF3rio",Z.classList.add("u-text-main"),E=!0);let C=t.trim();if(C===""?(X.textContent="Preencher este campo obrigat\xF3rio",X.classList.add("u-text-main"),E=!0):zt(C)||(X.textContent="Insira um email v\xE1lido",X.classList.add("u-text-main"),E=!0),!E){try{let I=await s,O=await o;d=await Ve(I),l=await Ve(O)}catch{console.error("Failed to load PDF"),d=null}let P={name:e,email:t,check:a,file:d,to_company_email:"contact@fabricstore.pt",to_user_email:t,reply_to:"general@brightweb.tech"},S={name:e,email:t,check:a,file:l,to_company_email:"contact@fabricstore.pt",reply_to:"general@brightweb.tech"};emailjs.send("service_fabricstore","template_quote_pdf",P).then(function(I){console.log("SUCCESS!",I.status,I.text),J.style.display="none",U.style.display="none",u.textContent="Obrigado pelo seu contacto!"},function(I){console.log("FAILED...",I),J.style.display="none",U.style.display="none",u.textContent="Oops! Algo correu mal!"}),emailjs.send("service_fabricstore","template_quote_txt",S).then(function(I){console.log("SUCCESS!",I.status,I.text),J.style.display="none",U.style.display="none",u.textContent="Obrigado pelo seu contacto!"},function(I){console.log("FAILED...",I),J.style.display="none",U.style.display="none",u.textContent="Oops! Algo correu mal!"})}},ea=()=>{let e=125;for(let t=0;t<5;t++)e=125+t*125,h.push({inicio:"Cortina",tecido:"101015-003",tipo:"Ondas",medidas:`${e} X 250`,correcao:t%2!==0,calha:"5000-Branco",instalacao:t%2===0})},ta=()=>{h.push({inicio:"Cortina",tecido:"120100-008",tipo:"Franzido",medidas:"200 X 250",correcao:!0,calha:"5000-B",instalacao:!0})},aa=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];le.value="ritabreu@test.pt",re.value="Rita Abreu",h.push(...e)},oa=()=>{let e=[{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"348 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];le.value="ritabreu@test.pt",re.value="Rita Abreu",h.push(...e)},sa=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"360 X 150",correcao:!1,calha:"5000-B",instalacao:!1}];h.push(...e)},ia=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"350 X 240",correcao:!0,calha:"5000-B",instalacao:!0}];h.push(...e)};Ye()});})();
