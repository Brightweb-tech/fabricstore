"use strict";(()=>{window.Webflow||(window.Webflow=[]);window.Webflow.push(()=>{let Y={spaceBetween:12,allowTouchMove:!1,resistanceRatio:0,watchOverflow:!0,keyboard:{enabled:!0,onlyInViewport:!1},navigation:{nextEl:".slider-main_button.swiper-btn-next",prevEl:".slider-main_button.swiper-btn-prev"},breakpoints:{320:{slidesPerView:1},480:{slidesPerView:2},640:{slidesPerView:3},1024:{slidesPerView:6}}},G=new Swiper(".swiper",Y),ot=()=>{G.destroy(),G=new Swiper(".swiper",Y)},S={},re={Branco:"B",Inox:"I",Bronze:"BZ",Preto:"P",Nogueira:"N",Chumbo:"CH"},x={estores:{width:[80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],height:[80,100,120,140,160,180,200,220,240,260,280,300,320]},calhas:{"5000-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"5000-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"1500-B":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-I":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-BZ":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-P":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-N":[120,140,160,180,200,220,240,260,300,320,340,360,400,440,500,600],"1500-CH":[120,140,160,180,200,220,240,260,300,350,400,450,500],"9500M":[150,200,250,300,350,400,450,500,600,650,700,750,800,850,900,1e3,1200],KS:[160,200,240,300,400,500,600],"DSXL-B":[160,200,240,300,400,600],"DSXL-CZ":[160,200,240,300,400,600],"DSXL-P":[160,200,240,300,400,600]}},D=[],u={step1:document.getElementById("simulator-heading-1"),step2:document.getElementById("simulator-heading-2"),step3:document.getElementById("simulator-heading-3"),step4:document.getElementById("simulator-heading-4"),step5:document.getElementById("simulator-heading-5")},o={inicio:document.getElementById("inicio-selector"),tecido:document.getElementById("tecido-selector"),tipo:document.getElementById("tipo-selector"),bainha:document.getElementById("bainha-selector"),medidas:document.getElementById("medidas-selector"),correcao:document.getElementById("correcao-selector"),suporte:document.getElementById("suporte-selector"),instalacao:document.getElementById("instalacao-selector")},le=()=>{let e=document.querySelectorAll("[id^='inicio-card']"),t=document.querySelectorAll("[id^='tipo-card']"),a=document.querySelectorAll("[id^='tecido-card']"),s=document.querySelectorAll(".tecido_color");e.forEach(c=>{W(c)}),t.forEach(c=>{W(c)}),a.forEach(c=>{W(c)}),s.forEach(c=>{Z(c)}),b.value="",v.value="",X.checked=!1,A.checked=!1,$?.click(),F.checked=!1},b=document.getElementById("largura-input"),v=document.getElementById("altura-input"),X=document.querySelector("#correcao-switch"),A=document.querySelector("#instalacao-switch"),F=document.querySelector("#bainha"),M=document.getElementById("nome-input"),H=document.getElementById("email-input"),de=document.getElementById("contacto-switch"),ue=document.getElementById("cortina-radio-btn"),he=document.getElementById("estore-radio-btn"),me=document.getElementById("calha-radio-btn"),V=document.getElementById("tecto-radio-btn"),$=document.getElementById("parede-radio-btn"),T=document.getElementById("seguinte-btn"),Q=document.getElementById("sim-container"),ee=document.getElementById("checkout-container"),pe=document.getElementById("new-window-contain"),fe=document.getElementById("checkout-input-contain"),ge=document.getElementById("new-window-btn"),Ce=document.getElementById("no-window-btn"),be=document.getElementById("enviar-btn"),h=[],p={tecido:document.getElementById("step-tecido"),tipo:document.getElementById("step-tipo"),medidas:document.getElementById("step-medidas"),calha:document.getElementById("step-calha"),instalacao:document.getElementById("step-instalacao")},P={tecido:document.getElementById("checkout-tecido"),tipo:document.getElementById("checkout-tipo"),bainha:document.getElementById("checkout-bainha"),largura:document.getElementById("checkout-largura"),altura:document.getElementById("checkout-altura"),correcao:document.getElementById("checkout-correcao"),calha:document.getElementById("checkout-calha"),suporte:document.getElementById("checkout-suporte"),instalacao:document.getElementById("checkout-instalacao")},m="inicio",r={inicio:"",tecido:"",tipo:"",bainha:"",medidas:"",correcao:"",calha:"",suporte:"",instalacao:"",nome:"",email:"",contacto:""},f={usedWidths:[{name:"Franzido",widthRatio:2.5},{name:"Ondas",widthRatio:2.7},{name:"Macho Juntos",widthRatio:3},{name:"Pregas",widthRatio:2.5}],manufacturingPrices:[{name:"Franzido",blackout:9,normal:8},{name:"Ondas",blackout:8.5,normal:7.5},{name:"Macho Juntos",normal:13.5,blackout:13.5},{name:"Pregas",normal:13.5,blackout:13.5}],bainhaPrice:{price:3.5,widthMargin:20},uniao:{maxLength:400,price:8.6},prolongadores:3.7,roletesPrice:5,minWindowWidth:80,maxWindowWidth:650,minWindowHeight:80,maxWindowHeight:280,maxCalhaWidth:600,measuresCheckPrice:30,instalation:[{maxWidth:300,price:35},{maxWidth:400,price:40},{maxWidth:500,price:45},{maxWidth:600,price:50},{maxWidth:650,price:55}]},ve=e=>{let t=f.usedWidths.find(a=>e.tipo===a.name);return t?(e.medidas?parseInt(e.medidas.split(" X ")[0]):0)*t.widthRatio+f.bainhaPrice.widthMargin:0},Ee=(e,t,a,s)=>{let c=x.estores.width.find(d=>d>=a),l=x.estores.height.find(d=>d>=s);return`${e}${l}${c}`},Be=(e,t,a,s,c)=>{if(e==="KS"){if(c){let n=x.calhas[e]?.find(g=>g>=s);return`${e}${t==="Franzido"?"F":"O"}${n}SP`}let d=x.calhas[e]?.find(n=>n>=s);return`${e}${t==="Franzido"?"F":"O"}${d}`}if(e==="DSXL"){if(c){let n=x.calhas[`${e}-${a}`]?.find(g=>g>=s);return`${e}${t==="Franzido"?"F":"O"}${n}${a}SP`}let d=x.calhas[`${e}-${a}`]?.find(n=>n>=s);return`${e}${t==="Franzido"?"F":"O"}${d}${a}`}if(e==="9500M"){if(c){let n=x.calhas[e].find(g=>g>=s);return`${e}${n}SP`}let d=x.calhas[e].find(n=>n>=s);return`${e}${d}`}if(c){let d=x.calhas[`${e}-${a}`].find(n=>n>=s);return`${e}${d}${a}SP`}let l=x.calhas[`${e}-${a}`].find(d=>d>=s);return`${e}${l}${a}`},nt=e=>re[e],ke=e=>{let t=0,a=0,s="",c=e.tecido.split("-"),l=c[0],d=c[1],n=e.calha?e.calha.split("-"):null,g=n?n[0]:null,U=n?n[1]:null,I=e.medidas?e.medidas.split(" X ")[0]:0;if(e.inicio==="Cortina"&&(s=`${l}${d}`),e.inicio==="Estore"){let K=e.medidas?e.medidas.split(" X ")[1]:0;s=Ee(l,d,I,K)}if(t=typeof S[s].price=="string"?parseFloat(S[s].price):S[s].price,e.inicio==="Estore")return{product:t,calha:0};let L=(I/f.maxCalhaWidth|0)+1,w=I<=f.maxCalhaWidth?I:I/L,O=Be(g,e.tipo,U,w,e?.suporte==="Parede");return a=S[O]?I<f.maxCalhaWidth?S[O].price:S[O].price*L:0,a+=I>f.maxCalhaWidth?f.prolongadores*L:I>f.uniao.maxLength?f.uniao.price*L:0,(O.startsWith("5000")||O.startsWith("1500"))&&(a+=I<f.maxCalhaWidth?f.roletesPrice:f.roletesPrice*L),{product:t,calha:a}},ye=(e,t)=>{let a=e.medidas.split(" X ")[0],s=0,c=0,l=ke(e);return e.inicio==="Cortina"&&(s=l.product*(t/100),c=l.calha),e.inicio==="Estore"&&(s=l.product),{product:s,calha:c}},Pe=(e,t)=>{if(e.inicio==="Estore")return 0;let a=f.manufacturingPrices.find(s=>e.tipo===s.name);return a?e.tecido.startsWith("101")?a.blackout*(t/100):a.normal*(t/100):0},Ie=(e,t)=>e.inicio==="Cortina"&&(e.tecido.startsWith("120")||e.tecido.startsWith("122"))||e.inicio==="Estore"?0:e.bainha?f.bainhaPrice.price*(t/100):0,st=e=>e.correcao?f.measuresCheckPrice:0,xe=e=>{if(!h[0].instalacao)return 0;let t=parseInt(e.medidas.split(" X ")[0]),a=f.instalation.find(s=>t<=s.maxWidth);return a?a.price:0},We=e=>{let t=ve(e),a=ye(e,t),s=Pe(e,t),c=Ie(e,t),l=xe(e),d=a.product+s+c+a.calha+l;return e.totalPrice=d,{usedWidth:t,productPrice:a.product,manufacturingPrice:s,bainhaPrice:c,calhaPrice:a.calha,instalationPrice:l,windowTotal:d}},i=(e,t)=>{e.style.display=t?"flex":"none"},E=(e,t)=>{r[e.id.split("-")[0]]=t},j=e=>{r.calha=e},te=e=>{r.suporte=$.checked?"Parede":"Tecto"},Se=()=>{r.inicio="",r.tecido="",r.tipo="",r.bainha="",r.medidas="",r.correcao="",r.calha="",r.suporte="",r.instalacao=""},B=()=>{switch(m){case"inicio":return r.inicio===""?(alert("Por favor selecione um valor"),!1):!0;case"tecido":return r.tecido===""?(alert("Por favor selecione um valor"),!1):!0;case"tipo":return r.tipo===""?(alert("Por favor selecione um valor"),!1):!0;case"medidas":return b?.value===""||v?.value===""?(alert("Preencha valores v\xE1lidos de largura e altura"),C(!1),!1):parseInt(b?.value)>f.maxWindowWidth?(alert("Largura m\xE1xima excedida"),C(!1),!1):parseInt(v?.value)>f.maxWindowHeight?(alert("Altura m\xE1xima excedida"),C(!1),!1):!0;case"calha":return r.calha===""?(alert("Por favor selecione um valor"),!1):!0;case"suporte":return r.suporte===""?(alert("Por favor selecione um valor"),!1):!0}return!0},$e=()=>{Object.keys(p).forEach(e=>{p[e].classList.remove("active"),p[e].classList.add("next"),p[e].classList.remove("done"),p[e].getElementsByClassName("step_number")[0].classList.remove("active"),p[e].getElementsByClassName("step_description")[0].textContent="Escolha"})},k=e=>{p[e].classList.remove("active"),p[e].classList.remove("next"),p[e].classList.add("done"),p[e].getElementsByClassName("step_number")[0].classList.remove("active"),p[e].getElementsByClassName("step_description")[0].textContent=r[e],e==="medidas"&&(p[e].getElementsByClassName("step_description")[0].textContent+=r.correcao?"c/Verifica\xE7\xE3o":"s/Verifica\xE7\xE3o"),e==="tipo"&&(p[e].getElementsByClassName("step_description")[0].textContent+=r.bainha?"c/Ba\xEDnha de Chumbo":"s/Ba\xEDnha de Chumbo")},y=e=>{p[e].classList.remove("next"),p[e].classList.add("active"),p[e].getElementsByClassName("step_number")[0].classList.add("active")},Le=e=>{if(p[e].classList.contains("active")&&(p[e].classList.remove("active"),p[e].getElementsByClassName("step_number")[0].classList.remove("active")),p[e].classList.contains("done"))return k(e);p[e].classList.add("next")},C=e=>{e&&T?.classList.contains("inactive")&&T.classList.remove("inactive"),e||T?.classList.contains("inactive")||T.classList.add("inactive")},rt=e=>{Object.keys(e).forEach(t=>{E(o.medidas,e[t])})},lt=e=>{Oe(e.inicio),Ne(e.tecido),selectTipo(e.tipo),F.checked=e.bainha,b.value=e.medidas.split(" X ")[0],v.value=e.medidas.split(" X ")[1],X.checked=e.correcao,selectSuporte(e.suporte),A.checked=e.instalacao},Oe=e=>{document.querySelectorAll("[id^='inicio-card']").forEach(a=>{a.getElementsByTagName("h1")[0].textContent===e?N(a):W(a)})},Ne=e=>{document.querySelectorAll("[id^='tecido-card']").forEach(a=>{oe(a).startsWith(e)?N(a):W(a)})},Te=()=>{if(r.inicio==="Cortina")switch(m){case"inicio":B()&&(i(o.inicio,!1),C(!1),i(o.tecido,!0),m="tecido");break;case"tecido":B()&&(k("tecido"),y("tipo"),i(u.step1,!1),C(!1),i(o.tecido,!1),i(u.step2,!0),i(o.tipo,!0),m="tipo");break;case"tipo":B()&&(i(o.tipo,!1),r.tecido.startsWith("120")||r.tecido.startsWith("122")?(E(o.bainha,!0),C(!1),k("tipo"),y("medidas"),i(u.step2,!1),i(u.step3,!0),i(o.medidas,!0),m="medidas"):(i(o.bainha,!0),m="bainha"));break;case"bainha":E(o.bainha,`${r.tecido.startsWith("120")||r.tecido.startsWith("122")?!0:r.bainha?r.bainha:!1}`),k("tipo"),y("medidas"),i(u.step2,!1),i(o.bainha,!1),C(!1),i(u.step3,!0),i(o.medidas,!0),m="medidas";break;case"medidas":B()&&(E(o.medidas,`${b?.value} X ${v?.value}`),i(o.medidas,!1),h.length>0?(C(!1),q("Calha"),k("medidas"),y("calha"),i(u.step3,!1),i(u.step4,!0),i(o.tecido,!0),m="calha"):(i(o.correcao,!0),m="correcao"));break;case"correcao":q("Calha"),k("medidas"),y("calha"),i(u.step3,!1),i(o.correcao,!1),C(!1),i(u.step4,!0),i(o.tecido,!0),m="calha";break;case"calha":B()&&(i(o.tecido,!1),C(!1),Xe(),i(o.suporte,!0),m="suporte");break;case"suporte":E(o.suporte,$?.checked?"Parede":"Tecto"),B()&&(k("calha"),y("instalacao"),i(u.step4,!1),i(o.suporte,!1),h.length>0?(z(),_(),R()):(i(u.step5,!0),i(o.instalacao,!0),m="instalacao"));break;case"instalacao":k("instalacao"),i(u.step5,!1),i(o.instalacao,!1),z(),_(),R();break}else switch(m){case"inicio":B()&&(i(o.inicio,!1),i(o.tecido,!0),m="tecido");break;case"tecido":B()&&(k("tecido"),y("medidas"),i(u.step1,!1),i(o.tecido,!1),i(u.step3,!0),i(o.medidas,!0),m="medidas");break;case"medidas":B()&&(E(o.medidas,`${b?.value} X ${v?.value}`),i(o.medidas,!1),h.length>0?(k("medidas"),y("instalacao"),i(u.step3,!1),i(u.step5,!0),i(o.instalacao,!0),m="instalacao"):(i(o.correcao,!0),m="correcao"));break;case"correcao":k("medidas"),y("instalacao"),i(u.step3,!1),i(o.correcao,!1),h.length>0?(z(),_(),R()):(i(u.step5,!0),i(o.instalacao,!0),m="instalacao");break;case"instalacao":k("instalacao"),i(u.step5,!1),i(o.instalacao,!1),z(),_(),R();break}},Xe=()=>{V.checked=!1,$.checked=!1},_=()=>{let e=document.querySelector("#checkout-window-btn"),t=document.getElementById("window-btns-container");if(h.length===1&&(h[0].button=e,ae(h[0])),h.length>1&&e){let a=e.cloneNode(!0);a.querySelector("h6").textContent=`Janela ${h.length}`,h[h.length-1].button=a,ae(h[h.length-1]),t?.appendChild(a)}},ae=e=>{e.button.addEventListener("click",()=>{ie(e)})},ie=e=>{h.forEach(t=>{t.button&&t.button.classList.remove("active")}),e.button.classList.add("active"),He(e)},R=()=>{Q.style.display="none",ie(h[h.length-1]),ee.style.display="flex"},ce=e=>{switch(ee.style.display="none",$e(),Q.style.display="flex",(e==="largura"||e==="altura")&&(e="medidas"),e){case"inicio":i(u.step1,!0),i(o.inicio,!0);break;case"tecido":i(u.step1,!0),i(o.tecido,!0);break;case"tipo":i(u.step2,!0),i(o.tipo,!0);break;case"medidas":i(u.step3,!0),i(o.medidas,!0);break;case"calha":i(u.step4,!0),i(o.tecido,!0);break;case"instalacao":i(u.step5,!0),i(o.instalacao,!0);break}if(m=e,m==="inicio")return y("tecido");y(e)},J=e=>{e.classList.add("active")},Z=e=>{e.classList.remove("active")},N=e=>{let t=e.getElementsByTagName("h1")[0],a=e.getElementsByClassName("tecido_image_contain")[0];e.classList.add("selected"),t.classList.add("active"),a.classList.add("active")},W=e=>{let t=e.getElementsByTagName("h1")[0],a=e.getElementsByClassName("tecido_image_contain")[0];e.classList.remove("selected"),t.classList.remove("active"),a.classList.remove("active")},q=e=>{e==="Estore"&&he?.click(),e==="Cortina"&&ue?.click(),e==="Calha"&&me?.click()},Ae=()=>{let e=document.querySelectorAll("[id^='inicio-card']");e.forEach(t=>{t.addEventListener("click",()=>{let a=t.getElementsByTagName("h1")[0].textContent;N(t,o.inicio),e.forEach(s=>{s!==t&&W(s)}),q(a),E(o.inicio,a),B()&&C(!0)})})},Fe=()=>{let e=document.querySelectorAll("[id^='tecido-card']"),t=document.querySelectorAll(".tecido_color");e.forEach(a=>{a.addEventListener("click",()=>{let s=oe(a),c=Ve(a),l=D.find(n=>n.product===s),d=a.getElementsByClassName("tecido_color");if(t.forEach(n=>Z(n)),N(a,o.tecido),e.forEach(n=>{n!==a&&W(n)}),l){for(let n=0;n<d.length;n++)d.item(n).id===`${l.color}`&&J(d.item(n));m==="tecido"&&E(o.tecido,l.color),m==="calha"&&j(l.color)}else d.length>0&&J(d[0]),m==="tecido"&&c!==""&&E(o.tecido,`${c}`),m==="calha"&&c!==""&&j(c);B()&&C(!0)})})},Ve=e=>{let t=e.getElementsByClassName("color_name");return t.length>0?t[0].textContent:null},oe=e=>{let t=e.getElementsByClassName("product_name");return t.length>0?t[0].textContent:null},_e=()=>{let e=document.querySelectorAll("[id^='calha-card']");e.forEach(t=>{t.addEventListener("click",()=>{N(t,o.calha),e.forEach(a=>{a!==t&&W(a)}),E(o.calha,t.getElementsByTagName("h1")[0].textContent)})})},Re=()=>{let e=document.querySelectorAll("[id^='tipo-card']");e.forEach(t=>{t.addEventListener("click",()=>{N(t,o.tipo),e.forEach(a=>{a!==t&&W(a)}),E(o.tipo,t.getElementsByTagName("h1")[0].textContent),B()&&C(!0)})})},qe=()=>{F.addEventListener("change",function(e){E(o.bainha,F.checked)})},ze=()=>{X.addEventListener("change",function(e){E(o.correcao,X.checked)})},De=()=>{A.addEventListener("change",function(e){E(o.instalacao,A.checked)})},Me=()=>{let e=document.querySelectorAll(".tecido_color");e.forEach(t=>{t.addEventListener("click",a=>{let s=a.currentTarget,c=s&&s.id;J(s),e.forEach(g=>{g!==s&&Z(g)});let l=c?c.split("-")[0]:"",d=D.find(g=>g.product===l);d?d.color=`${c}`:D.push({product:l,color:`${c}`});let n=s.parentElement.parentElement.parentElement.parentElement.getElementsByClassName("tecido_image")[0];for(let g=0;g<e.length;g++)if(e[g].getAttribute("id")===c){n.setAttribute("src",e[g].getElementsByTagName("img")[0].getAttribute("src")),n.setAttribute("srcset","");break}return m==="calha"&&c!==""?j(c):m==="tecido"&&c!==""?E(o.tecido,c):console.log("No color was stored")})})},He=e=>{P.tecido.textContent=e.tecido,P.tipo.textContent=e.tipo,P.bainha.textContent=e.tipo==="Ondas"||h.tipo==="Franzido"?"Ba\xEDnha de Chumbo inclu\xEDda":e.bainha?"Com Ba\xEDnha de Chumbo":"Sem Ba\xEDnha de Chumbo",P.largura.textContent=e.medidas.split(" X ")[0]+"cm Largura",P.altura.textContent=e.medidas.split(" X ")[1]+"cm Altura",P.correcao.textContent=h[0].correcao?"Com Verifica\xE7\xE3o":"Sem Verifica\xE7\xE3o",P.calha.textContent=e.calha,P.suporte.textContent="Suporte de "+e.suporte,P.instalacao.textContent=h[0].instalacao?"Com Instala\xE7\xE3o":"Sem Instala\xE7\xE3o"},je=e=>{switch(e){case"tecido":case"inicio":return"step1";case"tipo":case"bainha":return"step2";case"medidas":case"correcao":return"step3";case"calha":return"step4";case"instalacao":return"step5"}},Je=e=>{if((e==="largura"||e==="altura")&&(e="medidas"),e!==m&&p[e].classList.contains("done")){switch(Le(m),i(u[je(m)],!1),i(m==="calha"?o.tecido:o[m],!1),e){case"tecido":i(u.step1,!0),i(o.tecido,!0);break;case"tipo":i(u.step2,!0),i(o.tipo,!0);break;case"medidas":i(u.step3,!0),i(o.medidas,!0);break;case"calha":i(u.step4,!0),i(o.tecido,!0);break;case"instalacao":i(u.step5,!0),i(o.instalacao,!0);break}m=e,y(e)}},Ze=()=>{Object.keys(p).forEach(e=>{p[e].addEventListener("click",()=>{Je(e)})})},Ue=()=>{Object.keys(P).forEach(e=>{P[e].addEventListener("click",()=>{ce(e)})})},we=()=>{be.addEventListener("click",()=>{r.nome=M.value,r.email=H.value,r.contacto=de.checked,tt()})},Ke=()=>{ge.addEventListener("click",et)},Ye=()=>{Ce.addEventListener("click",()=>{pe.style.display="none",fe.style.display="flex"})},Ge=()=>{$?.addEventListener("change",e=>{($?.checked===!0||V?.checked===!0)&&(te("Parede"),B()&&C(!0))}),V?.addEventListener("change",e=>{($?.checked===!0||V?.checked===!0)&&(te("Tecto"),B()&&C(!0))})},Qe=()=>{b?.addEventListener("input",e=>{b?.value===""&&v?.value===""||parseInt(b?.value)<=f.minWindowWidth||parseInt(v?.value)<=f.minWindowHeight||(b?.value!==""&&v?.value!==""&&E(o.medidas,`${b?.value} X ${v?.value}`),b?.value!==""&&v?.value!==""&&(B()?C(!0):C(!1)))}),v?.addEventListener("input",e=>{b?.value===""&&v?.value===""||parseInt(b?.value)<=f.minWindowWidth||parseInt(v?.value)<=f.minWindowHeight||(b?.value!==""&&v?.value!==""&&E(o.medidas,`${b?.value} X ${v?.value}`),b?.value!==""&&v?.value!==""&&(B()?C(!0):C(!1)))})},z=()=>{let e={inicio:r.inicio,bainha:r.bainha,tecido:r.tecido,tipo:r.tipo,medidas:r.medidas,correcao:r.correcao,calha:r.calha,suporte:r.suporte,instalacao:r.instalacao};h.push(e)},et=()=>{q("Cortina"),Se(),le(),ce("inicio")},tt=()=>{let{jsPDF:e}=window.jspdf,t=new e,a=10,s=190,c=10,l=6,d=0;t.setFontSize(12),t.text("Data: "+new Date().toLocaleDateString(),s-40,c),t.text("Cliente: "+r.nome,a,c),c+=l,t.text("Email: "+r.email,a,c),c+=l*2,h.forEach((n,g)=>{g%6===0&&g!==0&&(t.addPage(),c=10);let{usedWidth:U,productPrice:I,manufacturingPrice:L,bainhaPrice:w,calhaPrice:O,instalationPrice:K,windowTotal:ne}=We(n);d+=ne;let ct=`Janela ${g+1} - ${n.medidas} CM - (Largura Utilizada: ${parseInt(parseFloat(U).toFixed(2))} CM)`;t.setFontSize(10),t.text(ct,a,c),t.text(`${ne.toFixed(2)}\u20AC`,a+150,c),c+=l,[{label:`Tecido: ${n.tecido}`,price:I},{label:`Tipo de Cortina: ${n.tipo}`,price:L},{label:`Ba\xEDnha de Chumbo: ${n.tecido.startsWith("120")||n.tecido.startsWith("122")?"Inclu\xEDda":n.bainha?"Sim":"N\xE3o"}`,price:w},{label:`Calha: ${n.calha} - Suporte: Suporte de ${n.suporte}`,price:O},{label:`Instala\xE7\xE3o: ${h[0].instalacao?"Sim":"N\xE3o"}`,price:K}].forEach(se=>{t.setFontSize(8),t.text(`  - ${se.label}`,a+5,c),t.text(`${se.price.toFixed(2)}\u20AC`,a+150,c),c+=l}),c+=l}),!h.length===6&&(c+=l),t.setFontSize(10),t.text("Corre\xE7\xE3o:",a,c),t.text(`${h[0].correcao?30:0}\u20AC`,a+150,c),c+=l,c+=l,d+=h[0].correcao?30:0,t.setFontSize(10),t.setFont("helvetica","bold"),t.setFillColor(240,240,240),t.rect(a,c,190,l+2,"F"),t.text("Total:",a+120,c+l-2),t.text(`${d.toFixed(2)}\u20AC`,a+150,c+l-2),t.save("generated.pdf")},dt=()=>{let e=125;for(let t=0;t<5;t++)e=125+t*125,h.push({inicio:"Cortina",tecido:"101015-003",tipo:"Ondas",medidas:`${e} X 250`,correcao:t%2!==0,calha:"5000-Branco",instalacao:t%2===0})},ut=()=>{h.push({inicio:"Cortina",tecido:"120100-008",tipo:"Franzido",medidas:"200 X 250",correcao:!0,calha:"5000-B",instalacao:!0})},ht=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"348 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];H.value="ritabreu@test.pt",M.value="Rita Abreu",h.push(...e)},mt=()=>{let e=[{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 150",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"348 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"240 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"280 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0},{inicio:"Cortina",tecido:"118060-024",tipo:"Ondas",bainha:!0,medidas:"285 X 268",correcao:!0,calha:"5000-B",suporte:"Parede",instalacao:!0}];H.value="ritabreu@test.pt",M.value="Rita Abreu",h.push(...e)},pt=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"360 X 150",correcao:!1,calha:"5000-B",instalacao:!1}];h.push(...e)},ft=()=>{let e=[{inicio:"Cortina",tecido:"120100-008",tipo:"Ondas",medidas:"350 X 240",correcao:!0,calha:"5000-B",instalacao:!0}];h.push(...e)},at=()=>{fetch("https://docs.google.com/spreadsheets/d/1hkgiYOVj33yY6b--bJaNPZOvHFvQ4klM402z0xp-gjE/export?format=csv&gid=0&single=true").then(e=>e.text()).then(e=>{let t=e.trim().split(`
`),a=t[0].split(","),s=t.slice(1).map(l=>l.split(",")),c={};s.forEach(l=>{let[d,n]=l;c[d]||(c[d]={id:d,price:parseFloat(n)})}),S=c}).catch(e=>console.error("Error fetching CSV data:",e))},it=()=>{T.addEventListener("click",Te)};at(),it(),Ae(),Fe(),_e(),Re(),qe(),ze(),De(),Me(),we(),Ke(),Ye(),Ue(),Ze(),Qe(),Ge()});})();
